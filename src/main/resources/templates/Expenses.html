<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org" th:fragment="header"
	xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="stylesheet" type="text/css"
	href="/webjars/bootstrap/4.3.1/css/bootstrap.min.css"
	th:href="@{/webjars/bootstrap/4.3.1/css/bootstrap.min.css}">
<link rel="stylesheet" type="text/css"
	href="/webjars/font-awesome/5.9.0/css/all.min.css"
	th:href="@{/webjars/font-awesome/5.9.0/css/all.min.css}">
<link rel="stylesheet" type="text/css"
	href="/webjars/jquery-ui/1.12.1/jquery-ui.min.css"
	th:href="@{/webjars/jquery-ui/1.12.1/jquery-ui.min.css}">
<link rel="stylesheet" type="text/css"
	href="/webjars/datatables/1.10.19/css/jquery.dataTables.min.css"
	th:href="@{/webjars/datatables/1.10.19/css/jquery.dataTables.min.css}">


<script src="/webjars/bootstrap/4.3.1/js/bootstrap.min.js"
	th:src="@{/webjars/bootstrap/4.3.1/js/bootstrap.min.js}"></script>
<script src="/webjars/popper.js/1.14.7/umd/popper.min.js"
	th:src="@{/webjars/popper.js/1.14.7/umd/popper.min.js}"></script>
<script src="/webjars/jquery/3.4.1/jquery.min.js"
	th:src="@{/webjars/jquery/3.4.1/jquery.min.js}"></script>
<script src="/webjars/jquery-ui/1.12.1/jquery-ui.min.js"
	th:src="@{/webjars/jquery-ui/1.12.1/jquery-ui.min.js}"></script>
<script src="/webjars/datatables/1.10.19/js/jquery.dataTables.min.js"
	th:src="@{/webjars/datatables/1.10.19/js/jquery.dataTables.min.js}"></script>
<script
	src="/webjars/datatables/1.10.19/js/dataTables.bootstrap4.min.js"
	th:src="@{/webjars/datatables/1.10.19/js/dataTables.bootstrap4.min.js}"></script>

<script src="/webjars/jquery-form/4.2.2/jquery.form.min.js"
	th:src="@{/webjars/jquery-form/4.2.2/jquery.form.min.js}"></script>

<script src="/webjars/jquery-validation/1.19.0/jquery.validate.min.js"
	th:src="@{/webjars/jquery-validation/1.19.0/jquery.validate.min.js}"></script>

<link rel="stylesheet" type="text/css"
	href="webjars/chartjs/2.8.0/Chart.min.css"
	th:href="@{webjars/chartjs/2.8.0/Chart.min.css}">
<script src="webjars/chartjs/2.8.0/Chart.min.js"
	th:src="@{webjars/chartjs/2.8.0/Chart.min.js}"></script>

<link rel="shortcut icon" th:href="@{/favicon.ico}" type="image/x-icon">
<link rel="icon" th:href="@{/favicon.ico}" type="image/x-icon">

<link
	href="https://fonts.googleapis.com/css?family=Nunito:400,600|Open+Sans:400,600,700"
	rel="stylesheet">
<link rel="stylesheet" href="css/spur.css">


<title>ERP</title>

<style type="text/css">
.dash-nav-item {
	min-height: 20px;
	padding: 8px 10px 8px 8px;
	letter-spacing: .01em;
}

.dash-nav-dropdown-item {
	min-height: 10px;
	padding: 8px 10px 8px 10px;
}

td {
	background-color: #f8f7ff;
}

.dash-toolbar {
	min-height: 60px;
	background-color: #FFF;
}

.dash-nav.dash-nav-dark {
	background-color: #525252;
}

.img-container {
	text-align: center;
	display: block;
	margin-left: auto;
	margin-right: auto;
	text-align: center;
	display: table-cell;
	vertical-align: middle
}

.card-title {
	margin-bottom: 0.25rem;
}

.card-header {
	padding: 0.25rem 0.25rem;
	margin-bottom: 0;
	border-bottom: 1px solid rgba(0, 0, 0, 0.125);
}

.dataTables_wrapper .dataTables_paginate .paginate_button {
	padding: 0px;
	margin: 20dp
}

.menu-title-header {
	padding: 0.45rem 0.45rem;
	background: #727F94;
	color: #fff;
	font-family: "Nunito", sans-serif;
}

.spur-card-title {
	font-family: "Nunito", sans-serif;
	font-size: 25px;
}

.dataTables_wrapper .dataTables_paginate .paginate_button {
	box-sizing: border-box;
	display: inline-block;
	min-width: 1.5em;
	/* padding: 0.5em 1em; */
	margin-left: 2px;
	font-size: 15px;
	text-align: center;
	text-decoration: none !important;
	cursor: pointer;
	*cursor: hand;
	color: #d03535 !important;
	border-radius: 2px;
	height: 30px;
	text-align: center;
}

.dataTables_wrapper .dataTables_info, .dataTables_wrapper .dataTables_paginate
	{
	float: none;
	font-size: 15px;
	text-align: center;
	margin-left: 10px;
}

.table.dataTable thead th, table.dataTable thead td {
	padding: 10px 10px;
	font-weight: normal;
}
</style>
<style>
#pagination-controls {
	margin: 20px 0;
}

.pagination-btn {
	margin: 0 5px;
	padding: 5px 10px;
	border: 1px solid #007bff;
	background-color: #f8f9fa;
	color: #007bff;
	cursor: pointer;
}

.pagination-btn:hover {
	background-color: #007bff;
	color: white;
}

body {
	font-family: Arial, sans-serif;
	background-color: #f9f9f9;
	margin: 0;
	padding: 20px;
}

h1 {
	text-align: center;
	color: #333;
}

table {
	width: 100%;
	border-collapse: collapse;
	margin-top: 20px;
	margin-bottom: 20px;
}

table, th, td {
	border: 1px solid #ccc;
}

th, td {
	padding: 10px;
	text-align: left;
}

th {
	background-color: #f0f0f0;
}

tr:nth-child(even) {
	background-color: #f7f7f7;
}

.debit {
	color: red;
	text-align: right;
}

.credit {
	color: green;
	text-align: right;
}

footer {
	text-align: center;
	margin-top: 30px;
	font-size: 0.8em;
	color: #666;
}
</style>
</head>
<script>

function Home() {

	location.href = 'Dashboard';
}



function back(event) {
    event.preventDefault();
	window.history.back();
}


function historys(event) {

    event.preventDefault();
	location.href = './Inward?formmode=history';
}

function listt(event) {
    event.preventDefault();  // Prevent the default form submission behavior
    location.href = './expenses';
}

	
</script>

<script>
function product_name_typeFunction1() {
    const productName = document.getElementById('productName').value;  // Get the selected product name
    const category_name = document.getElementById('category_name');
    const batchSelect = document.getElementById('batch');  // Select the batch dropdown

    // Make an AJAX request to get batches based on the product name
    $.ajax({
        url: "./getStocksss?product_id=" + encodeURIComponent(productName),  // Use product name as the query parameter
        type: 'GET',
        dataType: "json",
        success: function(res) {
            let options = '<option>SELECT</option>';  // Default option
            
            $.each(res, function(index, data) {
                const values = Object.values(data);
                category_name.value = values[1];
                options += `<option value="${values[0]}">${values[0]}</option>`;  // Assuming first value is batch
            });

            // Update the batch select field
            batchSelect.innerHTML = options;

            // Remove duplicate options if any
            const uniqueOptions = [];
            batchSelect.querySelectorAll('option').forEach(option => {
                if (uniqueOptions.includes(option.value)) {
                    option.remove();
                } else {
                    uniqueOptions.push(option.value);
                }
            });
        },
        error: function() {
            batchSelect.innerHTML = '<option>Error retrieving batch</option>';  // Handle errors
        }
    });
}





</script>

<script type="text/javascript">
function submitgj() {

	 // Validate the category_name fiel
            // Your validation rules
            
      if ($("#Inward_add").valid()) {  
    
    // Proceed with the AJAX request if validation passes
    $.ajax({
        url: './Addinward',
        type: 'POST',
        data: $('#Inward_add').serialize(),
        success: function (response) {
        	$("#alertmsg").text(response);
        	$("#alert").modal("toggle");
        }
    });
    
}
}



</script>
<script>

// Function to calculate total debit and credit
function calculateTotals() {
    let totalDebit = 0;
    let totalCredit = 0;

    // Calculate total for the General Journal table
    document.querySelectorAll("#dataTables .debit").forEach((cell) => {
        totalDebit += parseFloat(cell.innerText) || 0;
    });
    document.querySelectorAll("#dataTables .credit").forEach((cell) => {
        totalCredit += parseFloat(cell.innerText) || 0;
    });

    // Calculate total for the Salaries table
    document.querySelectorAll("#dataTables_salaries .debit").forEach((cell) => {
        totalDebit += parseFloat(cell.innerText) || 0;
    });
    document.querySelectorAll("#dataTables_salaries .credit").forEach((cell) => {
        totalCredit += parseFloat(cell.innerText) || 0;
    });

    // Calculate total for the Sales table
    document.querySelectorAll("#dataTables_sales .debit").forEach((cell) => {
        totalDebit += parseFloat(cell.innerText) || 0;
    });
    document.querySelectorAll("#dataTables_sales .credit").forEach((cell) => {
        totalCredit += parseFloat(cell.innerText) || 0;
    });

    // Update the totals in the footer
    document.getElementById('totalDebit').innerText = '-'+totalDebit.toFixed(2);
    document.getElementById('totalCredit').innerText = totalCredit.toFixed(2);
}

// Call the function after page load or when data is modified
window.onload = calculateTotals;
</script>



<script type="text/javascript">

    var pageSize = 10; // Set page size for pagination

    function showPage(tableId, page) {
        var $table = $('#' + tableId + ' tbody');
        var rows = $table.find('tr');
        var pageCount = Math.ceil(rows.length / pageSize);
        rows.hide();
        rows.slice((page - 1) * pageSize, page * pageSize).show();

        var $paginationControls = $('#pagination-controls-' + tableId);
        $paginationControls.empty();

        for (var i = 1; i <= pageCount; i++) {
            $paginationControls.append('<button class="pagination-btn" onclick="showPage(\'' + tableId + '\', ' + i + ')">' + i + '</button> ');
        }
    }

    // Initial Page load for all tables
    $(document).ready(function () {
        showPage('dataTables', 1);
        showPage('dataTables_salaries', 1);
        showPage('dataTables_sales', 1);
    });

    // Search Functionality
    function searchTable(tableId, searchInputId) {
        var input = $('#' + searchInputId).val().toUpperCase();
        var $table = $('#' + tableId + ' tbody');
        var rows = $table.find('tr');

        rows.each(function () {
            var cells = $(this).find('td');
            var found = false;

            cells.each(function () {
                if ($(this).text().toUpperCase().indexOf(input) > -1) {
                    found = true;
                    return false; // Exit loop early
                }
            });

            if (found) {
                $(this).show();
            } else {
                $(this).hide();
            }
        });
    }
    
    
    function addg(a){
    	
    	var poid = $(a).val();
    	//alert(poid);
    	location.href = 'QualityCheck?formmode=QualityCheck&poid='+poid;
    }
    
         
</script>


<script>
function qualitycheck() {
    // Debugging alert


    // Get the value from the input
    var poId1 = document.getElementById('poNumber').value;


    // Check if poId1 is not empty
    if (poId1) {
        console.log("PO ID:", poId1); // Additional logging

        $.ajax({
            url: './CheckQuality',
            type: 'POST',
            data: { poId: poId1 },
            success: function (response) {
                // Update the alert message and toggle the modal
                $("#alertmsg").text(response);
                $("#alert").modal("toggle");
            },
            error: function (xhr, status, error) {
                // Handle any error responses
                console.error("AJAX error:", status, error);
                alert("An error occurred while checking quality.");
            }
        });
    } else {
        // Alert if the ID is not found
        alert("ID Not Found");
    }
}


</script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Get the current date in 'YYYY-MM-DD' format
        const today = new Date().toISOString().split('T')[0];
        // Set the value of the date input field to today's date
        document.getElementById('inDate').value = today;
    });
</script>



<script>
function addexpenses(event){
	event.preventDefault();
	
	location.href='./expenses?formmode=addexpenses';
}


function expsubmit(event){
	
	event.preventDefault();

	
	   $.ajax({
	        url: './addexpenses11',
	        type: 'POST',
	        data: $('#expensesadd').serialize(),
	        success: function (response) {
	        	$("#alertmsg").text(response);
	        	$("#alert").modal("toggle");
	        	
	         
	        }
	    });
	
	
}
	
	



</script>
<body>
	<!-- sideMenu -->
	<div class="container-fluid">
		<div class="row">
			<!-- Sidebar (Left) -->
			<div class="col-sm-2">
				<div th:insert="BTMHeaderMenu :: header"></div>
			</div>
			<!-- Main Content (Right) -->
			<div class="col-sm-10">
				<div class="container-fluid content"
					th:if="${formmode}=='addexpenses'">
					<div class="row">
						<!-- Form for Journal Entry -->
						<form action="#" id="expensesadd" method="post" class="w-100"
							autocomplete="off">
							<div class="card">

								<div class="card-header"
									style="font-family: 'Nunito', sans-serif; font-size: 23px; font-weight: 600;">

									<div class="float-left">
										<h6 style="font-size: 1.5rem; margin-top: 10px; color: black;">
											Expenses-Add
											<!-- <span th:text="${inquiry.poId}">
										
										</span> -->
										</h6>
									</div>
									<div class="float-right" style="padding: 5px;">
										<!-- //<button class="btn btn-primary" onclick="addpo(event);" th:if="${formmode=='list'}">Add</button> -->
										<button class="btn btn-primary" onclick="listt(event);">list</button>

									</div>


								</div>

								<!-- Form Body -->
								<div class="card-body">
									<div class="form-group">
										<div class="row formline" style="margin-top: 20px;">


											<div class="col-sm-2">
												<label for="from">Expenses ID</label>
											</div>
											<div class="col-sm-3">
												<input type="text" id="Exp_id" name="Exp_id" readonly th:value="${expppid}"
													class="form-control form-control-sm" autocomplete="off" />
											</div>

											<div class="col-sm-1"></div>

											<div class="col-sm-2">
												<label for="from">Expenses Type</label>
											</div>
											<div class="col-sm-3">
												<!-- <input type="text" id="Exp_type" name="Exp_type"
													required class="form-control form-control-sm"
													autocomplete="off"  /> -->

												<select id="Exp_type" name="Exp_type" class="form-control form-control-sm">
													<option value="">select</option>
													<option value="EXPENSES">EXPENSES</option>
													<option value="EMPLOYEE EXPENSES">EMPLOYEE
														EXPENSES</option>
													<option value="TRAVEL EXPENSES">TRAVEL EXPENSES</option>
													<option value="OTHER EXPENSES">OTHER EXPENSES</option>
												</select>
											</div>



										</div>
										<div class="row formline" style="margin-top: 20px;">
											<div class="col-sm-2">
												<label for="to">Date</label>
											</div>
											<div class="col-sm-3">
												<input type="date" id="Exp_date" name="Exp_date" required
													class="form-control form-control-sm" autocomplete="off" />

											</div>

											<div class="col-sm-1"></div>
											<div class="col-sm-2">
												<label for="fromAcctype">Notes</label>
											</div>
											<div class="col-sm-3">
												<input type="text" id="Notes" name="Notes"
													class="form-control form-control-sm" autocomplete="off" />

											</div>
										</div>


										<div class=" col-sm-13 text-center" style="margin-top: 10px;">
											<div class="card-footer text-center"
												style="font-family: 'Nunito', sans-serif; font-size: 23px; font-weight: 600; letter-spacing: 0.5px; line-height: 1.5; text-transform: capitalize; color: #333; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);">
												<button class="btn btn-xs btn-primary mr-2" type="button"
													id="Dashboard" onclick="Home()">Home</button>
												<button class="btn btn-xs btn-primary mr-2" type="button"
													id="Dashboard" onclick="expsubmit(event)">submit</button>
												<button class="btn btn-xs btn-primary" id="btnback"
													type="button" onclick="back(event);">Back</button>

											</div>
										</div>










									</div>
								</div>
						</form>
					</div>
				</div>

				<!--poList -->
				<div class="container-fluid content" th:if="${formmode}=='list'">
					<div class="row">
						<div class="col-sm-12">
							<form autocomplete="off" id="list_po" method="POST">
								<div class="card" style="margin-top: 10px;">
									<div class="card-header"
										style="font-family: 'Nunito', sans-serif; font-size: 23px; font-weight: 600;">
										<div class="d-flex justify-content-between align-items-center"
											style="padding: 5px;">
											<div class="spur-card-title">Expenses List</div>
											<span>
												<button onclick="addexpenses(event);">Add</button>
											</span>
										</div>

										<!-- <div class="float-right" style="padding: 5px;">
											<button class="btn btn-primary" onclick="historys(event);">history</button>

										</div>
 -->
									</div>

									<div class="card-body" style="padding: 1rem;">
										<!-- Search Input -->
										<div class="mb-3">
											<input type="text" id="searchInput" placeholder="Search..."
												onkeyup="searchTable('dataTables', 'searchInput')"
												class="form-control" style="width: 18%; height: 34px;" />
										</div>

										<!-- Table for displaying journal entries -->
										<table id="dataTables" class="table table-striped">
											<thead>
												<tr>
													<th style="text-align: center;">Expenses ID</th>
													<th style="text-align: center;">Expenses Type</th>
													<th style="text-align: center;">Date</th>
													<th style="text-align: center;">Notes</th>


												</tr>
											</thead>
											<tbody id="table-body">
												<tr th:each="expenses : ${getexpenses}">

													<td style="text-align: center;"
														th:text="${expenses.Exp_id}"></td>
													<td style="text-align: center;"
														th:text="${expenses.Exp_type}"></td>
													<td style="text-align: center;"
														th:text="${#dates.format(expenses.Exp_date, 'dd-MM-yyyy')}"></td>

													<td style="text-align: center;" th:text="${expenses.Notes}"></td>

												</tr>

											</tbody>

										</table>

										<div id="pagination-controls-dataTables"></div>

									</div>


									<div class=" col-sm-13 text-center">
										<div class="card-footer text-center"
											style="font-family: 'Nunito', sans-serif; font-size: 23px; font-weight: 600; letter-spacing: 0.5px; line-height: 1.5; text-transform: capitalize; color: #333; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);">
											<button class="btn btn-xs btn-primary mr-2" type="button"
												id="Dashboard" onclick="Home()">Home</button>
											<button class="btn btn-xs btn-primary" id="btnback"
												type="button" onclick="back(event)">Back</button>

										</div>
									</div>
								</div>
							</form>
						</div>
					</div>
				</div>



			</div>
		</div>
	</div>
	<div class=" modal fade" id="alert">
		<div
			class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
			<div class="modal-content">
				<div class="menu-title-header">
					<div class="modal-title" id="exampleModalLabel"
						style="text-align: center; color: rgb(0, 0, 0);">ERPS</div>
				</div>
				<div class="modal-body"
					style="text-align: center; background-color: #c6ccd2">
					<p id="alertmsg"></p>
					<button type="button" class="btn btn-primary" data-dismiss="modal"
						onclick="listt(event);">Close</button>
				</div>
			</div>
		</div>
	</div>
</body>



</html>