<!--<p>COMPLETED BY MOHAMED SALIK.A.S</p>-->

<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" href="/webjars/bootstrap/4.3.1/css/bootstrap.min.css"
		th:href="@{/webjars/bootstrap/4.3.1/css/bootstrap.min.css}">
	<link rel="stylesheet" type="text/css" href="/webjars/font-awesome/5.9.0/css/all.min.css"
		th:href="@{/webjars/font-awesome/5.9.0/css/all.min.css}">
	<link rel="stylesheet" type="text/css" href="/webjars/jquery-ui/1.12.1/jquery-ui.min.css"
		th:href="@{/webjars/jquery-ui/1.12.1/jquery-ui.min.css}">
	<link rel="stylesheet" type="text/css" href="/webjars/datatables/1.10.19/css/jquery.dataTables.min.css"
		th:href="@{/webjars/datatables/1.10.19/css/jquery.dataTables.min.css}">
	<link rel="shortcut icon" th:href="@{/favicon.ico}" type="image/x-icon">
	<link rel="icon" th:href="@{/favicon.ico}" type="image/x-icon">

	<script src="/webjars/bootstrap/4.3.1/js/bootstrap.min.js"
		th:src="@{/webjars/bootstrap/4.3.1/js/bootstrap.min.js}"></script>
	<script src="/webjars/popper.js/1.14.7/umd/popper.min.js"
		th:src="@{/webjars/popper.js/1.14.7/umd/popper.min.js}"></script>
	<script src="/webjars/jquery/3.4.1/jquery.min.js" th:src="@{/webjars/jquery/3.4.1/jquery.min.js}"></script>
	<script src="/webjars/jquery-ui/1.12.1/jquery-ui.min.js"
		th:src="@{/webjars/jquery-ui/1.12.1/jquery-ui.min.js}"></script>

	<script src="/webjars/jquery-form/4.2.2/jquery.form.min.js"
		th:src="@{/webjars/jquery-form/4.2.2/jquery.form.min.js}"></script>

	<script src="/webjars/jquery-validation/1.19.0/jquery.validate.min.js"
		th:src="@{/webjars/jquery-validation/1.19.0/jquery.validate.min.js}"></script>

	<script src="/webjars/datatables/1.10.19/js/jquery.dataTables.min.js"
		th:src="@{/webjars/datatables/1.10.19/js/jquery.dataTables.min.js}"></script>
	<script src="/webjars/datatables/1.10.19/js/dataTables.bootstrap4.min.js"
		th:src="@{/webjars/datatables/1.10.19/js/dataTables.bootstrap4.min.js}"></script>

	<style>
		.btns {
			float: right;
			margin: 5px;
		}

		.col-sm-5 {
			padding-bottom: 15px;
		}

		.list-body {
			padding: 0px;
		}

		.error {
			color: red;
			padding-left: 10px;
		}

		.formline {
			padding-bottom: 4px;
		}

		#finusertb {
			width: 460px;
		}

		.dataTables_wrapper .dataTables_paginate .paginate_button {
			padding: 0px;
		}

		label {
			font-size: 13px;
		}

		fieldset {
			border: 1px solid #CCC;
			border-radius: 5px;
			padding: 10px;
			margin-top: 10px;
		}


		.filterable {
			margin-top: 15px;

		}

		.filterable .panel-heading .pull-right {
			margin-top: -20px;
		}

		.filterable .filters input[disabled] {
			background-color: transparent;
			border: none;
			cursor: auto;
			box-shadow: none;
			padding: 0;
			height: auto;
		}

		.filterable .filters input[disabled]::-webkit-input-placeholder {
			color: #333;
		}

		.filterable .filters input[disabled]::-moz-placeholder {
			color: #333;
		}

		.filterable .filters input[disabled]:-ms-input-placeholder {
			color: #333;
		}
	</style>

	<script>
		$(document).ready(function () {



			var currentTime = new Date();
			var m_names = ['January', 'February', 'March',
				'April', 'May', 'June', 'July',
				'August', 'September', 'October', 'November', 'December'];
			var m_namesvalues = ['01', '02', '03',
				'04', '05', '06', '07',
				'08', '09', '10', '11', '12'];


			var d_names = ['Sunday', 'Monday', 'Tuesday',
				'Wednesday', 'Thursday', 'Friday', 'Saturday'];
			d = new Date();


			var cur_date = d.getDate()-1;
			if (cur_date < 10) {

				var curr_date = "0" + cur_date;
			} else {
				var curr_date = cur_date;
			}
			var cur_month = d.getMonth() + 1;
			var curr_month = "0" + cur_month;
			var curr_year = d.getFullYear();

			var n = m_names[d.getMonth()];
			var j = m_namesvalues[d.getMonth()];
			var day = d_names[d.getDay()];

			var date = curr_date + "-" + curr_month
				+ "-" + curr_year;
			$('#CAL_MONTH').prepend(
				$('<option></option>').val(j).html(n));

			$('#CAL_DATE').val(date);


			$('select option')   //Remove Drop Down Empty Space
				.filter(function () {
					return !this.value || $.trim(this.value).length == 0 || $.trim(this.text).length == 0;
				})
				.remove();







		});

		$(document).ready(

			/* This is the function that will get executed after the DOM is fully loaded */
			function () {
				$("#CAL_DATE").datepicker({

					dateFormat: 'dd-mm-yy',
					changeMonth: true,//this option for allowing user to select month
					changeYear: true, //this option for allowing user to select from year range
					maxDate : new Date()
				});
			});

	</script>
	<script>
		$(document).ready(function () {
    var dateObj = new Date();
    var mon = dateObj.getUTCMonth() + 1;
    var month = mon < 10 ? "0" + mon : mon; // Add leading zero if needed

    var d = dateObj.getUTCDate() - 1;
    if (d < 1) {
        // If the day is 1, set it to the last day of the previous month
        var lastDayOfPrevMonth = new Date(dateObj.getUTCFullYear(), mon, 0).getUTCDate();
        d = lastDayOfPrevMonth;
        mon = mon - 1;
        month = mon < 10 ? "0" + mon : mon; // Update month with leading zero if needed
    }

    var day = "DATE_" + d;
    var year = dateObj.getUTCFullYear();

   // alert(day);

    $.ajax({
        url: "./getDailyActivity?",
        data: '&day=' + day + '&year=' + year + '&month=' + month,
        dataType: 'json',
        type: 'GET',
        async: true,
       success: function (res) {
    var b = JSON.stringify(res);
    //alert(b);
    console.log(b);

    for (var i = 0; i < res.length; i+=5) {
        dayval = res[i];
        var desc = res[i + 4].split("||")[6];
        var newStr1 = desc.replace(/~/g, ",");

        var type = res[i + 4].split("||")[5];
        var newStr = type.replace(/~/g, ",");

        $('#associateday').append('<tr><td style="text-align: left;">' + res[i] + '</td><td>' + res[i + 1] + '</td><td>' + newStr + '</td><td>' + newStr1 + '</td><td>' + res[i + 4].split("||")[7] + '</td><td><input type="radio" id="btnclick" onclick=fnclick("' + res[i] + '","' + month + '","' + year + '"); value=' + res[i] + '></td>');

        var myStr = $("#jobdes" + (i + 4)).val();
    }
}
,
        error: function () {
            alert("error");
        }
    });
});



	</script>

	<script>
		//Filter Table

		$(document)
			.ready(
				function () {
					$('.filterable .btn-filter')
						.click(
							function (event) {
								event.preventDefault();
								var $panel = $(this).parents(
									'.filterable'), $filters = $panel
										.find('.filters input'), $tbody = $panel
											.find('.table tbody');
								if ($filters.prop('disabled') == true) {
									$filters
										.prop('disabled', false);
									$filters.first().focus();
								} else {
									$filters.val('').prop(
										'disabled', true);
									$tbody.find('.no-result')
										.remove();
									$tbody.find('tr').show();
								}
							});

					$('.filterable .filters input')
						.keyup(
							function (e) {
								/* Ignore tab key */
								var code = e.keyCode || e.which;
								if (code == '9')
									return;
								/* Useful DOM data and selectors */
								var $input = $(this), inputContent = $input
									.val().toLowerCase(), $panel = $input
										.parents('.filterable'), column = $panel
											.find('.filters th')
											.index($input.parents('th')), $table = $panel
												.find('.table'), $rows = $table
													.find('tbody tr');
								/* Dirtiest filter function ever ;) */
								var $filteredRows = $rows
									.filter(function () {
										var value = $(this)
											.find('td').eq(
												column)
											.text()
											.toLowerCase();
										return value
											.indexOf(inputContent) === -1;
									});
								/* Clean previous no-result if exist */
								$table.find('tbody .no-result')
									.remove();
								/* Show all rows, hide filtered ones (never do that outside of a demo ! xD) */
								$rows.show();
								$filteredRows.hide();
								/* Prepend no-result row if all rows are filtered */
								if ($filteredRows.length === $rows.length) {
									$table
										.find('tbody')
										.prepend(
											$('<tr class="no-result text-center"><td colspan="'
												+ $table
													.find('.filters th').length
												+ '">No result found</td></tr>'));
								}
							});
				});



		function home() {
			location.href = 'Dashboard'
		}

		function back() {
			window.history.back();
		}
		function fnclick(a, b, c) {
			location.href = "./timesheetMaster?formmode=view1" + '&resId='
				+ a + '&month=' + b + '&year='
				+ c;


		}


	</script>

	<script>
		$(document).ready(function () {
			$("#CAL_DATE").change(function (e) {

				$("#associateday > tr").remove();

				var vals = e.target.value.split('-');
				var d = vals[0];
				day = "DATE_" + parseInt(d);
				var month = vals[1];
				var year = vals[2];


				$.ajax({
					url: "./getDailyActivity?",
					data: '&day=' + day + '&year=' + year + '&month=' + month,
					dataType: 'JSON',
					type: 'GET',
					async: true,
					success: function (res) {
						var b = JSON.stringify(res);
						console.log(b);
						for (var i = 0; i < res.length; i += 5) {

							var desc=res[i + 4].split("||")[6];
							 var newStr1 = desc.replace(/~/g, ",");
							 
						  var type=res[i + 4].split("||")[5];
						var newStr = type.replace(/~/g, ",");
							$('#associateday').append('<tr><td style="text-align: left;">' + res[i] + '</td><td >' + res[i + 1] + '</td><td >' +newStr+ '</td><td >' +newStr1+ '</td><td >' + res[i + 4].split("||")[7] + '</td><td><input type="radio"  id="btnclick"  onclick=fnclick("' + res[i] + '","' + month + '","' + year + '"); value=' + res[i] + '></td>');var myStr =$("#jobdes"+(i+4)).val();
						}
						
					}, error: function (res) {
						alert("error")
					}

				});
			});
		});
	</script>
	<script>


		function submitform(a) {
			if ($("#timeSheetmaster").valid()) {
				var empid = a.getAttribute("data-empid");
				var month = a.getAttribute("data-month");
				var year = a.getAttribute("data-year");
				var url = "./timeSheetEdit?empid=" + empid + '&month=' + month + '&year=' + year;

				$("#timeSheetmaster").attr('action', url);

				var options = {
					success: showResponse
				};

				$("#timeSheetmaster").ajaxSubmit(options);

				function showResponse(responseText, statusText, xhr, $form) {

					$("#alertmsg").text(responseText);

					$('#alert').modal("toggle");
				}
			}
		};


	</script>
	<script type="text/javascript">


		function fnadd() {
			if ($("#timeSheetmaster1").valid()) {
				var url = "./timeSheetAdd?";
				$("#timeSheetmaster1").attr('action', url);

				var options = {
					success: showResponse
				};

				$("#timeSheetmaster1").ajaxSubmit(options);

				function showResponse(responseText, statusText, xhr, $form) {

					$("#alertmsg").text(responseText);

					$('#alert').modal("toggle");
				}
			}

		};



	</script>
</head>
<title>ERP</title>

<body>
	<!-- <-----------------------------------------------------------TimesheetList-------------------------------------------------------------------------->
	<div class="container-fluid">
		<div class="row">

			<div class="col-sm-2">
				<div th:insert="BTMHeaderMenu :: header"></div>
			</div>
			<div class="col-sm-10">

				<div class="container-fluid" th:if="${formmode}=='list' OR ${formmode}=='null'">
					<div class="row">
						<div class="col-sm-12">
							<div class="container-fluid content">
								<div class="row">
									<div class="card w-100">
										<div class="card-body p-0">
											<div class="panel panel-primary filterable">
												<div class="card-header d-flex justify-content-between"
													style="background-color:#BBC3CB;">

													<h4>DAILY ACTIVITY REPORT</h4>
													<button th:if="${formmode}=='list'"
														class="btn text-white  btn-filter btn-primary">Filter</button>

												</div>

												<div class="col-sm-4" style="margin-top: 21px;">

													<label style="font-size:1.2rem;">Date</label>
													<div style="margin-left:30px;">
														<input type="text" name="CAL_DATE" id="CAL_DATE"
															class="form-control"
															style="margin-top: -40px;margin-left: 31px;width: 166px;"
															placeholder="dd-mm-yyyy">
													</div>
												</div>
												<br>
												<table class="table table-bordered" >
													<col width="70">
													<col width="125">
													<col width="84">
													<col width="225">
													<col width="70">
													<col width="70">
													<thead>
														<tr class="filters">

															<th><input type="text" class="form-control font-weight-bold"
																	placeholder="Emp ID" disabled></th>
															<th><input type="text" class="form-control font-weight-bold"
																	placeholder="Emp Name" disabled></th>
															<th><input type="text" class="form-control font-weight-bold"
																	placeholder="Job Type" disabled></th>

															<th><input type="text" class="form-control font-weight-bold"
																	placeholder="Job Description Details" disabled></th>

															<th><input type="text" class="form-control font-weight-bold"
																	placeholder="Holiday" disabled></th>
															<th><input type="text" class="form-control font-weight-bold"
																	placeholder="Select" disabled></th>

														</tr>
													</thead>
													<tbody id="associateday">

													</tbody>
												</table>
												<div class="card-footer text-center" style="background-color:#BBC3CB;">
													<button type="button" class="btn btn-primary" id="btnHome"
														onclick="home()">Home</button>
													<button type="button" class="btn btn-primary" id="btnBack"
														onclick="back()">Back</button>
												</div>
											</div>
										</div>
									</div>


								</div>

							</div>
						</div>
					</div>
				</div>
			</div>


			<div class="modal fade" id="alert">
				<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
					<div class="modal-content">
						<div class="menu-title-header">
							<div class="modal-title" id="exampleModalLabel"
								style="text-align: center; color: rgb(0, 0, 0);">BTM MANAGER</div>
						</div>
						<div class="modal-body" style="text-align: center; background-color: #c6ccd2">
							<p id="alertmsg" style="font-size: 16px;"></p>
							<button type="button" class="btn btn-primary" data-dismiss="modal"
								onclick="back();">Close</button>
						</div>
					</div>
				</div>
			</div>


</body>

</html>