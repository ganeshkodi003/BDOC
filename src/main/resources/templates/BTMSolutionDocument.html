<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css"
	href="/webjars/bootstrap/4.3.1/css/bootstrap.min.css"
	th:href="@{/webjars/bootstrap/4.3.1/css/bootstrap.min.css}">
<link rel="stylesheet" type="text/css"
	href="/webjars/font-awesome/5.9.0/css/all.min.css"
	th:href="@{/webjars/font-awesome/5.9.0/css/all.min.css}">
<link rel="stylesheet" type="text/css"
	href="/webjars/jquery-ui/1.12.1/jquery-ui.min.css"
	th:href="@{/webjars/jquery-ui/1.12.1/jquery-ui.min.css}">
<link rel="stylesheet" type="text/css"
	href="/webjars/datatables/1.10.19/css/jquery.dataTables.min.css"
	th:href="@{/webjars/datatables/1.10.19/css/jquery.dataTables.min.css}">
<link rel="shortcut icon" th:href="@{/favicon.ico}" type="image/x-icon">
<link rel="icon" th:href="@{/favicon.ico}" type="image/x-icon">
 <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

 <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <!-- Include Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <!-- Include jQuery Form Plugin if used -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.form/4.3.0/jquery.form.min.js"></script>
    <!-- Your custom script -->
<script src="/webjars/bootstrap/4.3.1/js/bootstrap.min.js"
	th:src="@{/webjars/bootstrap/4.3.1/js/bootstrap.min.js}"></script>
<script src="/webjars/popper.js/1.14.7/umd/popper.min.js"
	th:src="@{/webjars/popper.js/1.14.7/umd/popper.min.js}"></script>
<script src="/webjars/jquery/3.4.1/jquery.min.js"
	th:src="@{/webjars/jquery/3.4.1/jquery.min.js}"></script>
<script src="/webjars/jquery-ui/1.12.1/jquery-ui.min.js"
	th:src="@{/webjars/jquery-ui/1.12.1/jquery-ui.min.js}"></script>

<script src="/webjars/jquery-form/4.2.2/jquery.form.min.js"
	th:src="@{/webjars/jquery-form/4.2.2/jquery.form.min.js}"></script>

<script src="/webjars/jquery-validation/1.19.0/jquery.validate.min.js"
	th:src="@{/webjars/jquery-validation/1.19.0/jquery.validate.min.js}"></script>
 <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.form/4.3.0/jquery.form.min.js"></script>
   
<script src="/webjars/datatables/1.10.19/js/jquery.dataTables.min.js"
	th:src="@{/webjars/datatables/1.10.19/js/jquery.dataTables.min.js}"></script>
<script
	src="/webjars/datatables/1.10.19/js/dataTables.bootstrap4.min.js"
	th:src="@{/webjars/datatables/1.10.19/js/dataTables.bootstrap4.min.js}"></script>

<style>
.btns {
	float: right;
	margin: 5px;
}

.col-sm-5 {
	padding-bottom: 15px;
}

.list-body {
	padding: 0px;
}

.error {
	color: red;
	padding-left: 10px;
}

.formline {
	padding-bottom: 4px;
}

#finusertb {
	width: 460px;
}

.dataTables_wrapper .dataTables_paginate .paginate_button {
	padding: 0px;
}
.filterable .filters input[disabled] {
	background-color: transparent;
	border: none;
	cursor: auto;
	box-shadow: none;
	padding: 0;
	height: auto;
}

.filterable .filters input[disabled]::-webkit-input-placeholder {
	color: #333;
}

.filterable .filters input[disabled]::-moz-placeholder {
	color: #333;
}

.filterable .filters input[disabled]:-ms-input-placeholder {
	color: #333;
}
.nav-tabs .nav-item.show .nav-link, .nav-tabs .nav-link.active {
	border: 2px solid skyblue !important;
	border-bottom: unset !important;
	background-color: unset !important;
	color: black !important;
	background-color: unset !important;
}

nav {
	border-bottom: 2px solid grey;
}
</style>
<style>
        .pagination {
            margin: 20px 0;
            text-align: center;
        }
        .pagination button {
            margin: 0 5px;
            padding: 8px 16px;
            border: none;
            background-color: #4CAF50;
            color: white;
            cursor: pointer;
        }
        .pagination button:hover {
            background-color: #45a049;
        }
        .pagination button.disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
    </style>
<script th:inline="javascript">
	/*<![CDATA[*/
		
		
			$(document)
			.ready(
					function() {
						$('.filterable .btn-filter')
								.click(
										function(event) {
											event.preventDefault();
											var $panel = $(this).parents(
													'.filterable'), $filters = $panel
													.find('.filters input'), $tbody = $panel
													.find('.table tbody');
											if ($filters.prop('disabled') == true) {
												$filters
														.prop('disabled', false);
												$filters.first().focus();
											} else {
												$filters.val('').prop(
														'disabled', true);
												$tbody.find('.no-result')
														.remove();
												$tbody.find('tr').show();
											}
										});

						$('.filterable .filters input')
								.keyup(
										function(e) {
											/* Ignore tab key */
											var code = e.keyCode || e.which;
											if (code == '9')
												return;
											/* Useful DOM data and selectors */
											var $input = $(this), inputContent = $input
													.val().toLowerCase(), $panel = $input
													.parents('.filterable'), column = $panel
													.find('.filters th')
													.index($input.parents('th')), $table = $panel
													.find('.table'), $rows = $table
													.find('tbody tr');
											/* Dirtiest filter function ever ;) */
											var $filteredRows = $rows
													.filter(function() {
														var value = $(this)
																.find('td').eq(column)
																.text()
																.toLowerCase();
														return value
																.indexOf(inputContent) === -1;
													});
											/* Clean previous no-result if exist */
											$table.find('tbody .no-result')
													.remove();
											/* Show all rows, hide filtered ones (never do that outside of a demo ! xD) */
											$rows.show();
											$filteredRows.hide();
											/* Prepend no-result row if all rows are filtered */
											if ($filteredRows.length === $rows.length) {
												$table
														.find('tbody')
														.prepend(
																$('<tr class="no-result text-center"><td colspan="'
																		+ $table
																				.find('.filters th').length
																		+ '">No result found</td></tr>'));
											}
										});
					});
		
		/* $(document).ready(function() {
				$(".checkToView").on('click',function() {
					alert()
							$(this).prop('checked', true);

							var resId = $(this).val();

							var formmode = "view";

							location.href = 'solutionDocument?formmode='
									+ formmode +"&doc_id="+resId ;

						});
			}); */

	



	function home() {
		location.href = 'Dashboard'
	}

	function back() {
		window.history.back();
	}

	
	function fnClick(a) {
		var userid = a.getAttribute("data-userid")
		location.href = 'UserProfile?formmode=edit&userid=' + userid
	}

	function add() {
		location.href = 'solutionDocument?formmode=add';
	}

	function list() {
		location.href = 'UserProfile?formmode=list';
	}


	/*]]>*/
</script>
<script>

$(document).ready(function() {
    $("#uploaddoc").on('submit', function(event) {
        event.preventDefault(); // Prevent default form submission
        

        if ($(this).valid()) {
            var formData = new FormData(this);
            var url = "./uploadDocss?";

            $.ajax({
                url: url,
                type: 'POST',
                data: formData,
                processData: false, // Prevent jQuery from automatically transforming the data into a query string
                contentType: false, // Ensure the correct content type is used (multipart/form-data)
                success: function(response) {
                   $("#alertmsg").text(response);
                    $('#alert').modal("toggle");
                },
                error: function(xhr) {
                    $("#alertmsg").text("File upload failed: " + xhr.responseText);
                    $('#alert').modal("toggle");
                }
            });
        }
    });
});

</script>
<script th:inline="javascript">


$(document).ready( function () {
	/*<![CDATA[*/
        const solutionDocList = /*[[${solutionDocList}]]*/ []; 
        
    	//alert(solutionDocList.length )
        const rowsPerPage = 20;
        let currentPage = 1;
        let totalPages = Math.ceil(solutionDocList.length / rowsPerPage);

        function renderTable() {
            const tableBody = document.getElementById('associatemonth');
            tableBody.innerHTML = "";

            const start = (currentPage - 1) * rowsPerPage;
            const end = start + rowsPerPage;
            const paginatedData = solutionDocList.slice(start, end);

            paginatedData.forEach(solutionDoc => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${solutionDoc.doc_ref_no}</td>
                    <td>${solutionDoc.doc_id}</td>
                    <td>${solutionDoc.doc_type}</td>
                    <td>${solutionDoc.doc_location}</td>
                    <td>${solutionDoc.doc_name}</td>
                    <td><input class="form-control-md checkToView" type="radio" value="${solutionDoc.doc_ref_no}" onclick="checkToView(this)"/></td>
                `;
                tableBody.appendChild(tr);
            });

            document.getElementById('page-info').textContent = `Page ${currentPage} of ${totalPages}`;
            document.getElementById('prev-btn').classList.toggle('disabled', currentPage === 1);
            document.getElementById('next-btn').classList.toggle('disabled', currentPage === totalPages);
        }

     

        // Initialize table
        renderTable();
        document.getElementById("prev-btn").addEventListener("click", function(event) {
            event.preventDefault(); // Prevents the default action, if any
          //  alert("Previous button clicked");
            if (currentPage > 1) {
                currentPage--;
                renderTable();
            }
        });

        document.getElementById("next-btn").addEventListener("click", function(event) {
            event.preventDefault(); // Prevents the default action, if any
          //  alert("Next button clicked");
            if (currentPage < totalPages) {
                currentPage++;
                renderTable();
            }
        });
        });
        


/*]]>*/
 
    </script>
    <script type="text/javascript">
    
	function checkToView(a) {
		var resId = a.value;
		alert(resId)
				var formmode = "view";

				location.href = 'solutionDocument?formmode='
						+ formmode +"&doc_id="+resId ;

			};
    
    </script>
</head>
<title>ERP</title>
<body>
	<div class="container-fluid">
		<div class="row">
			<div class="col-sm-2">
				<div th:insert="BTMHeaderMenu :: header"></div>
			</div>
			<div class="col-sm-10">

				<!---------------------User List Ends--------------------------------------------------------->
				<!---------------------User Edit form Starts-------------------------------------------------->
				<div class="container-fluid content" th:if="${formmode}== 'list'">
					<div class="row">
						<form action="#" method="post" autocomplete="off"
							style="width: 100%">
							<div class="card">
							<div class="panel panel-primary filterable">
								<div class="card-header d-flex justify-content-between" style="background-color:#BBC3CB;">
								<h3>SOLUTION DOCUMENT</h3>
								<div class="btn-group nav-buttons float-right">
									<a class="btn text-white btn-filter btn-primary" style="height: 39px;transform: translateX(-6px);margin-top: 5px;" >Filter</a>
									<a class="btn btn-xs btn-primary btns" onclick="add()">Add Document</a>
									</div>
								</div>
								 <div class="card-body p-0">
        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr class="filters">
                        <th><input type="text" class="form-control font-weight-bold" placeholder="DocRefNo" disabled></th>
                        <th><input type="text" class="form-control font-weight-bold" placeholder="DocId" disabled></th>
                        <th><input type="text" class="form-control font-weight-bold" placeholder="DocType" disabled></th>
                        <th><input type="text" class="form-control font-weight-bold" placeholder="DocFormat" disabled></th>
                        <th><input type="text" class="form-control font-weight-bold" placeholder="DocName" disabled></th>
                        <th>Select</th>
                    </tr>
                </thead>
                <tbody id="associatemonth">
                    <!-- Rows will be dynamically populated -->
                </tbody>
            </table>
        </div>
    </div>
    <div class="pagination">
        <button id="prev-btn">Previous</button>
        <span id="page-info"></span>
        <button id="next-btn" >Next</button>
    </div>

								<div class="card-footer text-center" style="background-color:#BBC3CB;">
									<button type="button" class="btn btn-primary" id="btnHome"
										onclick="home()">Home</button>
									<button type="button" class="btn btn-primary" id="btnBack"
										onclick="back()">Back</button>
								</div>
							</div>
							</div>
						</form>
					</div>
				</div>


<div class="container-fluid content" th:if="${formmode}== 'view'">
					<div class="row">
						<form action="#" method="post" autocomplete="off"
							style="width: 100%">
							<div class="card">
								<div class="card-header d-flex justify-content-between" style="background-color:#BBC3CB;">
									<h3>SOLUTION DOCUMENT</h3>
								
								</div>
								<div class="card-body p-0">
									<div class="table-responsive">
										<table class="table">
											<thead>
												<tr class="filters">
													<th>DocRefNo</th>
													<th>DocId</th>
													<th>DocType</th>
													<th>DocFormat</th>
													<th>DocName</th>
													<th>Select</th>
												</tr>
											</thead>
											<tbody id="associatemonthly">
												<tr th:each="solutionDoc : ${solutionDocList}">
													<td th:text="${solutionDoc?.doc_ref_no}"></td>
													<td th:text="${solutionDoc?.doc_id}"></td>
													<td th:text="${solutionDoc?.doc_type}"></td>
													<td th:text="${solutionDoc?.doc_location}"></td>
													<td th:text="${solutionDoc?.doc_name}"></td>
													 <td><a th:href="@{'/' + ${solutionDoc?.doc_ref_no}}">download</a></td>
      </tr>
											</tbody>
										</table>
									</div>
								</div>
								<div class="card-footer text-center" style="background-color:#BBC3CB;">
									<button type="button" class="btn btn-primary" id="btnHome"
										onclick="home()">Home</button>
									<button type="button" class="btn btn-primary" id="btnBack"
										onclick="back()">Back</button>
								</div>
							</div>
						</form>
					</div>
				</div>
				
				
				<div class="container-fluid content" th:if="${formmode}== 'add'">
					<div class="row">
						<form action="#" method="post" autocomplete="off" id="uploaddoc"
						enctype="multipart/form-data"	style="width: 100%">
							<div class="card">
								<div class="card-header d-flex justify-content-between" style="background-color:#BBC3CB;">
									<h3>SOLUTION DOCUMENT</h3>
									
								</div>
								
									<div class="card-body p-3">
						<div class="form-group">
							<div class="row formline">
							<div class="col-sm-1"></div>
								<div class="col-sm-1.5">
									<label >Document Reference Number</label>
								</div>
								<div class="col-sm-2">

									<input type="text"  id="doc_ref_no"name="doc_ref_no" th:value="${refno}"  style="  transform: translateX(2px);"
										class="form-control form-control-sm" readonly/>
								</div>
								
								<div class="col-sm-1"></div>
								<div class="col-sm-2">
									<label style="margin-left:20px;">Document Name</label>
								</div>
								<div class="col-sm-2">

									<input type="text"  id="doc_name"name="doc_name" value=""
										class="form-control form-control-sm" required/>
								</div>
							</div>
							
							<div class="row formline">
							<div class="col-sm-1"></div>
								<div class="col-sm-1.5">
									<label >Document Id</label>
								</div>
								<div class="col-sm-2" style="margin-left:120px;">

									<input type="text"  id="doc_id"name="doc_id" value=""
										class="form-control form-control-sm" required/>
								</div>
								
								<div class="col-sm-1"></div>
								<div class="col-sm-2" style="transform: translateX(17px);">
									<label >Document Description</label>
								</div>
								<div class="col-sm-2">

									<input type="text"  id="doc_desc"name="doc_desc" value=""
										class="form-control form-control-sm" required/>
								</div>
							</div>
							
							<div class="row formline">
							<div class="col-sm-1"></div>
								<div class="col-sm-1.5">
									<label >Document Type</label>
								</div>
								<div class="col-sm-2" style="margin-left:100px;">

									<input  type="text"  id="doc_type"name="doc_type" value=""
										class="form-control form-control-sm" required />
								</div>
								
								<div class="col-sm-1"></div>
								<div class="col-sm-2" style="margin-left: 20px;">
									<label >Document Group</label>
								</div>
								<div class="col-sm-2" style="margin-left:-19px;">

									<input type="text"  id="doc_group"name="doc_group" value=""
										class="form-control form-control-sm" required/>
								</div>
							</div>
							
							<div class="row formline">
							<div class="col-sm-1"></div>
								<div class="col-sm-1.5">
									<label >File Name</label>
								</div>
								<div class="col-sm-2" style="margin-left:140px;">
								
									<input type="text"  id="file_name"name="file_name" 
										class="form-control form-control-sm" required/>
									
								</div>
								
								<div class="col-sm-1"></div>
								<div class="col-sm-2" style="margin-left: 20px;">
									<label >Select File</label>
								</div>
								<div class="col-sm-2" style="margin-left:-19px;">

									<input type="file" name="document" class="form-control form-control-sm"
										id="document"  required style=" height: 36px;"/>
										
								</div>
								
								<div class="col-sm-1.5">
								<div style=" margin-left: -0px; ">(Max. 20MB)</div>
								</div>
							</div>
							
						</div>
						
									
								
								<div class="card-footer text-center" style="background-color:#BBC3CB;">
									<button type="button" class="btn btn-primary" id="btnHome"
										onclick="home()">Home</button>
										<button type="submit" class="btn btn-primary" id="Submit"
										>Upload</button>
									<button type="button" class="btn btn-primary" id="btnBack"
										onclick="back()">Back</button>
								</div>
							</div>
							</div>
						</form>
					</div>
				</div>
</div>

			</div>
		</div>
			<br> 
			

	<div class="modal fade" id="alert">
		<div
			class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
			<div class="modal-content">
				<div class="menu-title-header">
					<div class="modal-title" id="exampleModalLabel"
						style="text-align: center; color: white;">CIM FINANCE</div>
				</div>
				<div class="modal-body"
					style="text-align: center; background-color: #c6ccd2">
					<p id="alertmsg" style="font-size: 16px;"></p>
					<button type="button" class="btn btn-primary" data-dismiss="modal"
						style="width: 120px" onclick="back();">Close</button>
				</div>
			</div>
		</div>
	</div>
</body>
</html>