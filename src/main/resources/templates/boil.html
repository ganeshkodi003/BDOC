<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org" th:fragment="header"
	xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link rel="stylesheet" type="text/css"
	href="/webjars/bootstrap/4.3.1/css/bootstrap.min.css"
	th:href="@{/webjars/bootstrap/4.3.1/css/bootstrap.min.css}">
<link rel="stylesheet" type="text/css"
	href="/webjars/font-awesome/5.9.0/css/all.min.css"
	th:href="@{/webjars/font-awesome/5.9.0/css/all.min.css}">
<link rel="stylesheet" type="text/css"
	href="/webjars/jquery-ui/1.12.1/jquery-ui.min.css"
	th:href="@{/webjars/jquery-ui/1.12.1/jquery-ui.min.css}">
<link rel="stylesheet" type="text/css"
	href="/webjars/datatables/1.10.19/css/jquery.dataTables.min.css"
	th:href="@{/webjars/datatables/1.10.19/css/jquery.dataTables.min.css}">


<script src="/webjars/bootstrap/4.3.1/js/bootstrap.min.js"
	th:src="@{/webjars/bootstrap/4.3.1/js/bootstrap.min.js}"></script>
<script src="/webjars/popper.js/1.14.7/umd/popper.min.js"
	th:src="@{/webjars/popper.js/1.14.7/umd/popper.min.js}"></script>
<script src="/webjars/jquery/3.4.1/jquery.min.js"
	th:src="@{/webjars/jquery/3.4.1/jquery.min.js}"></script>
<script src="/webjars/jquery-ui/1.12.1/jquery-ui.min.js"
	th:src="@{/webjars/jquery-ui/1.12.1/jquery-ui.min.js}"></script>
<script src="/webjars/datatables/1.10.19/js/jquery.dataTables.min.js"
	th:src="@{/webjars/datatables/1.10.19/js/jquery.dataTables.min.js}"></script>
<script
	src="/webjars/datatables/1.10.19/js/dataTables.bootstrap4.min.js"
	th:src="@{/webjars/datatables/1.10.19/js/dataTables.bootstrap4.min.js}"></script>


<link rel="stylesheet" type="text/css"
	href="webjars/chartjs/2.8.0/Chart.min.css"
	th:href="@{webjars/chartjs/2.8.0/Chart.min.css}">
<script src="webjars/chartjs/2.8.0/Chart.min.js"
	th:src="@{webjars/chartjs/2.8.0/Chart.min.js}"></script>

<link rel="shortcut icon" th:href="@{/favicon.ico}" type="image/x-icon">
<link rel="icon" th:href="@{/favicon.ico}" type="image/x-icon">

<link
	href="https://fonts.googleapis.com/css?family=Nunito:400,600|Open+Sans:400,600,700"
	rel="stylesheet">
<link rel="stylesheet" href="css/spur.css">


<title>ERP</title>

<style type="text/css">
.dash-nav-item {
	min-height: 20px;
	padding: 8px 10px 8px 8px;
	letter-spacing: .01em;
}

.dash-nav-dropdown-item {
	min-height: 10px;
	padding: 8px 10px 8px 10px;
}

td {
	background-color: #f8f7ff;
}

.dash-toolbar {
	min-height: 60px;
	background-color: #FFF;
}

.dash-nav.dash-nav-dark {
	background-color: #525252;
}

.img-container {
	text-align: center;
	display: block;
	margin-left: auto;
	margin-right: auto;
	text-align: center;
	display: table-cell;
	vertical-align: middle
}

.dash-app {
	margin-left: 380px ! important;
	margin-top: 110px;
	margin-right: 110px;
}

.card-title {
	margin-bottom: 0.25rem;
}

.card-header {
	padding: 0.25rem 0.25rem;
	margin-bottom: 0;
	border-bottom: 1px solid rgba(0, 0, 0, 0.125);
}

.dataTables_wrapper .dataTables_paginate .paginate_button {
	padding: 0px;
	margin: 20dp
}

.stats-secondary {
	color: #fff;
}

.menu-title-header {
	padding: 0.45rem 0.45rem;
	background: #727F94;
	color: #fff;
	font-family: "Nunito", sans-serif;
}

.spur-card-title {
	font-family: "Nunito", sans-serif;
	font-size: 25px;
}

.dataTables_wrapper .dataTables_paginate .paginate_button {
	box-sizing: border-box;
	display: inline-block;
	min-width: 1.5em;
	/* padding: 0.5em 1em; */
	margin-left: 2px;
	font-size: 15px;
	text-align: center;
	text-decoration: none !important;
	cursor: pointer;
	*cursor: hand;
	color: #d03535 !important;
	border-radius: 2px;
	height: 30px;
	text-align: center;
}

.dataTables_wrapper .dataTables_info, .dataTables_wrapper .dataTables_paginate
	{
	float: center;
	font-size: 15px;
	text-align: center;
	margin-left: 10px;
}

.table.dataTable thead th, table.dataTable thead td {
	padding: 10px 10px;
	font-weight: bold;
}

thead th {
	text-align: center;
	color: black !important;
	border-bottom-width: 2px;
	font-size: medium ! important;
}
</style>
<style type="text/css">
.navbar {
    margin-left: -5px;
    position: fixed; /* Keep it fixed */
    top: 0;
    width: 100%;
    z-index: 1000; /* Ensure it's above other elements */
}
.content {
    margin-top: 151px ! important; /* Push content down to avoid overlap */
}
.container-fluid {
    width: 100%;
    padding-right: 0px;
    padding-top:1px;
    padding-left: 15px;
    margin-right: auto;
    margin-left: auto;
}
.container-manager {
	padding-right: 47px;
	padding-left: 132px;
}
.row {
    display: -ms-flexbox;
    display: flex;
    -ms-flex-wrap: wrap;
    flex-wrap: wrap;
    margin-right: -8px;
    margin-left: -22px;
}
</style>
<script type="text/javascript">
$(document).ready(function () {
    $('.dropdown, .dropdown-submenu').hover(function () {
        $(this).children('.dropdown-menu').stop(true, true).delay(200).fadeIn(200);
    }, function () {
        $(this).children('.dropdown-menu').stop(true, true).delay(200).fadeOut(200);
    });
});
</script>


</head>


<script th:inline="javascript">
	$(function() {

		$("#dataTables").DataTable({
			"destroy" : true,
			"scrollY" : 400,
			"scrollCollapse" : true,
			"paging" : true,
			"autoWidth" : false,
			"ordering" : false,
			"searching" : false,
			"scrollX" : true,
			"pageLength" : 100,
			"lengthChange" : false,

		});
	});
	$(document).ready(function() {

		$("#Upload").on("click", function() {

			$.ajax({
				url : './fileimport',
				type : 'POST',
				data : new FormData($("#fileuploadd")[0]),
				enctype : 'multipart/form-data',
				processData : false,
				contentType : false,
				success : function(res) {
					window.alert(res);
					//location.href = './stockHistory'

				}
			});
			e.preventDefault();

		});
	});
	
	var checkff=true;

	function checkFields(){
		var fields = $('input.required');
		for (var i = 0; i < fields.length; i++) {
			if ($(fields[i]).val() != '') {
				window.alert("Enter all required fields");
				checkff=true;
			}else{
				checkff=false;
			}
		}
		
	}
	function singleStockHistory() {
		
		alert("Added Successfully!!!")



	};

	function singleStockCurrent() {
		const inputs = document.querySelectorAll('#addStockHistory input');
		for (var i = 0; i < inputs.length; i++) {
			if ($(inputs[i]).val() == '') {
				alert("Enter all required fields");
				break;
			}
		}
		if ($(inputs[i]).val() != '') {
		var expdate = document.getElementById('EXPIRY_DATEs').value;
		$.ajax({
			url : "./singleStockCurrent?expdate=" + expdate,
			dataType : "text",
			type : 'POST',
			aync : true,
			data : $('#addStockHistory').serialize(),
			success : function(res) {

				alert(res);
				location.href = './stockHistory'

			}
		});
		};
	};

	let batchlist =[];

	function getprice(input){
		
		

		 const row = input.closest('tr');
		 
		var batch= row.querySelector('select[name="batch"]').value;
		//alert(batch)
		

		 
		 batchlist.forEach(function(mufun) {
			 
		
			
			 
			 if(batch == mufun.batch ||batch==mufun.processId ||batch==mufun.fgId){
				 
			
				 
				 row.querySelector('input[name="price"]').value= mufun.price || '';
				 row.querySelector('input[name="stock_qty"]').value= mufun.useingqty ||mufun.useingquantity ||mufun.usingQuantity||'';

				 
				 
			 }
			 
		 });
		 
			 
	}
	let tineprice=0;
	function product_name_typeFunction1(input) {
	    const row = input.closest('tr');
	   
	    const productName = input.value;
	    const tableRows = document.querySelectorAll('#dynamicFieldsTable1 tbody tr');
	    var itemsplit =productName.split('-');
		var splitfinal=itemsplit[0];
		const batchSelect = row.querySelector('select[name="batch"]');
		var categorycode  = "";

		

	    
 		if(productName!='Loose Ghee'){
 			
 			
 			
 			//for getting item code
 			$.ajax({
 			        url: "./getitemdetails1?itemCode=" + encodeURIComponent(splitfinal),
 			        type: 'GET',
 			        dataType: "json",
 			        success: function(response) {
 			        	
 			        	
 			        	  if (response && response.length > 0) {
 			                  
 			                  var item = response[0]; 
 			                  
 			                  row.querySelector('input[name="itemname"]').value= item.itemName || '';
 			                  //row.querySelector('input[name="hsncode"]').value= item.hsnCode || '';
 			                  row.querySelector('input[name="category_name1"]').value= item.category || '';
 			                 categorycode=item.category;
 			                 //alert(categorycode) 
 			                  row.querySelector('input[name="baseunit"]').value= item.baseUnit || '';
 			                  //row.querySelector('input[name="category_name1"]').value= item.category || '';
 			                  //row.querySelector('input[name="price"]').value= item.purchasePrice || '';
 			                  } else {
 			            	  row.querySelector('input[name="itemname"]').value= '';
 			            	  //row.querySelector('input[name="hsncode"]').value= '';
 			            	  //row.querySelector('input[name="category_name1"]').value= '';
 			            	  //row.querySelector('input[name="baseunit"]').value= '';
 			            	  //row.querySelector('input[name="price"]').value= '';
 			                  }
 			        	 if(categorycode=='B01A'){
 			 				//alert("raw")
 			 				$.ajax({
 			 	 		        url: "./getbatch_price?itemCode=" + encodeURIComponent(splitfinal),
 			 	 		        type: 'GET',
 			 	 		        dataType: "json",
 			 	 		        success: function(response) {
 			 	 		        	
 			 	 		        	console.log("myresponseeee" +response);
 			 	 		        	
 			 	 		        	  var selectElement = row.querySelector('select[name="batch"]'); // Reference the select element
 			 	 		              selectElement.innerHTML = ''; // Clear existing options
 			 	 		              var defaultOption = document.createElement('option');
 			 	 		              defaultOption.value = '';
 			 	 		              defaultOption.text = 'Select a batch';
 			 	 		              selectElement.appendChild(defaultOption);        	
 			 	 		        	  if (response && response.length > 0) {
 			 	 		                 
 			 	 		        		  const batchSet = new Set(); 

 			 	 		        		  response.forEach(function(batch) {
 			 	 		        		      const values = Object.values(batch);
 			 	 		        		      console.log(values);

 			 	 		        		      for (let p = 0; p < tableRows.length; p++) {
 			 	 		        		          const rows = tableRows[p];
 			 	 		        		          var batchrow = rows.querySelector('select[name="batch"]').value;
 			 	 		        		          var itemCoderow = rows.querySelector('input[name="itemCode"]').value;
 			 	 		        		          batchSet.add(batchrow); 
 			 	 		        		          
 			 	 		        		      }
 			 	 		        		      if (batch.batch !== null && batch.useingqty > 0) {
 			 	 				                  if (!batchSet.has(batch.batch)) {         		                      
 			 	 				                      batchlist.push(batch);        		                      
 			 	 				                      var option = document.createElement('option');
 			 	 				                      option.value = batch.batch || ''; 
 			 	 				                      option.text = batch.batch || '-'; 
 			 	 				                      selectElement.appendChild(option); 
 			 	 				                  }
 			 	 				              }
 			 	 		        		  });

 			 	 		                  
 			 	 		                  console.log("patchlist" +batchlist);
 			 	 		                  
 			 	 		                 
 			 	 		                  } 	      
 			 	 		        }
 			 	 		    });	
 			 			}else{
 			 				$.ajax({
 			 	 		        url: "./getbatch_priceforfg?itemCode=" + encodeURIComponent(splitfinal),
 			 	 		        type: 'GET',
 			 	 		        dataType: "json",
 			 	 		        success: function(response) {
 			 	 		        	
 			 	 		        	console.log("myresponseeee" +response);
 			 	 		        	
 			 	 		        	  var selectElement = row.querySelector('select[name="batch"]'); // Reference the select element
 			 	 		              selectElement.innerHTML = ''; // Clear existing options
 			 	 		              var defaultOption = document.createElement('option');
 			 	 		              defaultOption.value = '';
 			 	 		              defaultOption.text = 'Select a batch';
 			 	 		              selectElement.appendChild(defaultOption);        	
 			 	 		        	  if (response && response.length > 0) {
 			 	 		                 
 			 	 		        		  const batchSet = new Set(); 

 			 	 		        		  response.forEach(function(batch) {
 			 	 		        		      const values = Object.values(batch);
 			 	 		        		      console.log(values);

 			 	 		        		      for (let p = 0; p < tableRows.length; p++) {
 			 	 		        		          const rows = tableRows[p];
 			 	 		        		          var batchrow = rows.querySelector('select[name="batch"]').value;
 			 	 		        		          var itemCoderow = rows.querySelector('input[name="itemCode"]').value;
 			 	 		        		          batchSet.add(batchrow); 
 			 	 		        		          
 			 	 		        		      }
 			 	 		        		      //alert(batch.fgId);
 			 	 		        		      if (batch.fgId !== null && batch.usingQuantity > 0) {
 			 	 				                  if (!batchSet.has(batch.fgId)) {         		                      
 			 	 				                      batchlist.push(batch);        		                      
 			 	 				                      var option = document.createElement('option');
 			 	 				                      option.value = batch.fgId || ''; 
 			 	 				                      option.text = batch.fgId || '-'; 
 			 	 				                      selectElement.appendChild(option); 
 			 	 				                  }
 			 	 				              }
 			 	 		        		  });

 			 	 		                  
 			 	 		                  console.log("patchlist" +batchlist);
 			 	 		                  
 			 	 		                 
 			 	 		                  } 	      
 			 	 		        }
 			 	 		    });	

 			 				
 			 			}  
 			      		
 			        }
 			    });
 			
 			
 			
 			  
 			
 			
 			
 			
 			
 			 		    
 		    
	
	    }else{
	    	//alert("loose ghee")
	    	row.querySelector('input[name="itemname"]').value="Loose Ghee";
	    	row.querySelector('input[name="baseunit"]').value= 'KILOGRAMS';
	    	row.querySelector('input[name="category_name1"]').value='B01C';
	    	$.ajax({
 		        url: "./getbatch_pricesfg?itemCode=" + encodeURIComponent(splitfinal),
 		        type: 'GET',
 		        dataType: "json",
 		        success: function(response) {
 		        	
 		        	//console.log("myresponseeee" +response);
 		        	
 		        	  var selectElement = row.querySelector('select[name="batch"]'); // Reference the select element
 		              selectElement.innerHTML = ''; // Clear existing options
 		              var defaultOption = document.createElement('option');
 		              defaultOption.value = '';
 		              defaultOption.text = 'Select a batch';
 		              selectElement.appendChild(defaultOption);        	
 		        	  if (response && response.length > 0) {
 		                 
 		        		  const batchSet = new Set(); 

 		        		  response.forEach(function(batch) {
 		        		      const values = Object.values(batch);
 		        		      console.log(values);

 		        		      for (let p = 0; p < tableRows.length; p++) {
 		        		          const rows = tableRows[p];
 		        		          var batchrow = rows.querySelector('select[name="batch"]').value;
 		        		          var itemCoderow = rows.querySelector('input[name="itemCode"]').value;
 		        		          batchSet.add(batchrow); 
 		        		          
 		        		      }
 		        		      if (batch.processId !== null && batch.useingquantity > 0) {
 				                  if (!batchSet.has(batch.batch)) {         		                      
 				                      batchlist.push(batch);        		                      
 				                      var option = document.createElement('option');
 				                      option.value = batch.processId || ''; 
 				                      option.text = batch.processId || '-'; 
 				                      selectElement.appendChild(option); 
 				                  }
 				              }
 		        		  });
	                 
 		                  } 	      
 		        }
 		    });
	    	
	    	 console.log("patchlist" +batchlist);
	    }
	    
	    
	    
	}

	function category(){
		
	}
	function back() {
		window.history.back();
	}
	function finaltotal(total){
		alert(total)

	}
	
	function totalcal(selectElement){
		const row = selectElement.closest('tr');
		const cost = row.querySelector('input[name="cost[]"]').value;
		const qnt = row.querySelector('input[name="KGS[]"]').value;
		const total = row.querySelector('input[name="total[]"]');
		total.value=qnt*cost;
		 finaltotal(total.value)

	}
	
	function getcurrentstock(selectElement) {
	    // Find the closest row (tr) to the changed select element
	    const row = selectElement.closest('tr');

	    // Get the product name from the input field in the same row
	    const pro_name = row.querySelector('input[name="product_name[]"]').value;

	    // Fetch the selected batch value
	    const batch = selectElement.value;

	    // Proceed with the AJAX requests
	    $.ajax({
	        url: "./getpkgtypeList?product_id=" + pro_name + "&batch=" + batch,
	        type: 'GET',
	        dataType: "json",
	        success: function(res) {
	            $.each(res, function(index, data) {
	                var i = Object.values(data);
	                // Update the corresponding fields in the same row
	                row.querySelector('input[name="EXPIRY_DATEs[]"]').value = i[1];
	                // Update other fields as needed using similar methods
	            });
	        }
	    });

	    $.ajax({
	        url: "./getCurrentStockfn?product_id=" + pro_name + "&batch=" + batch,
	        type: 'GET',
	        dataType: "json",
	        success: function(res) {
	            $.each(res, function(index, data) {
	                var i = Object.values(data);
	                // Update the corresponding fields in the same row
	                //row.querySelector('input[name="PKG[]"]').value = i[0];
	                row.querySelector('input[name="UNITS[]"]').value = i[1];
	                row.querySelector('input[name="cost[]"]').value = i[3];
	                row.querySelector('input[name="GSTIN[]"]').value = i[4];
	                row.querySelector('input[name="MRP[]"]').value = i[2];
	            });
	        }
	    });
	}

	
	document.addEventListener('DOMContentLoaded', function() {
	    const table = document.getElementById('dynamicFieldsTable').querySelector('tbody');

	    // Function to add a new row
	    function addRow() {
	        const newRow = document.createElement('tr');
	        newRow.innerHTML = `
	            <td>
	                <input type="text" name="product_name[]" list="pronameList" onchange="product_name_typeFunction1(this)" style="width: 100%;">
	                <datalist id="pronameList">
	                    <option th:each="operator : \${productList}" th:value="\${operator.PRODUCT_NAME}" th:text="\${operator.PRODUCT_NAME}"></option>
	                </datalist>
	            </td>
	            <td><select id="BATCH" name="batch[]" onchange="getcurrentstock(this)" style="width: 100%;">
                <option>SELECT</option>
	            </select></td>
	            <td><input type="text" name="UNITS[]" style="width: 100%;"></td>
	            <td><input type="text" name="category_name1[]" style="width: 100%;"></td>
	            <td><input type="text" name="PKG[]" style="width: 100%;"></td>
	            <td><input type="text" name="qty[]" style="width: 100%;"></td>
	            <td style="text-align: center;">
			    <div style="display: flex; gap: 10px; justify-content: center; align-items: center;">
			        <span class="add-btnn" style="cursor: pointer; font-size: 20px; color: green;">
			            <i class="fas fa-plus add-btnn"></i>
			        </span>
			        
			        <span class="remove-btnn" style="cursor: pointer; font-size: 20px; color: red;">
			            <i class="fas fa-trash remove-btnn"></i>
			        </span>
			    </div>
			</td>
	            
	            
	        `;
	        table.appendChild(newRow);
	    }
	    //<td><button type="button" class="btn btn-danger remove-btn">Remove</button></td>
	    

	    // Add event listener for the "Add" button
	    document.querySelector('.add-btn').addEventListener('click', function() {
	        addRow();
	    });

	    // Add event listener for removing a row
	    table.addEventListener('click', function(event) {
	        if (event.target.classList.contains('remove-btn')) {
	            event.target.closest('tr').remove();
	        }
	    });
	});



</script>

<script type="text/javascript">
/* function addTaxData(event) {
    event.preventDefault(); // Prevent the default form submission

    var productlist = [];
    var makename = document.getElementById('makingproductName').value;
    //alert(makename); 
    $('#dynamicFieldsTable tbody tr').each(function(index) {
        var row = $(this);
        console.log("Processing row " + index);
        console.log(row.html());  // Log the HTML of the current row to check its structure

        var productName = row.find('input[name="product_name[]"]').val();
        var batchs = row.find('select[name="batch[]"]').val();
        var gstin = row.find('input[name="GSTIN[]"]').val();
        var expdate = row.find('input[name="EXPIRY_DATEs[]"]').val();
        var mrp = row.find('input[name="MRP[]"]').val();
        var units = row.find('input[name="UNITS[]"]').val();
        var categoryName = row.find('input[name="category_name1[]"]').val();
        var pkg = row.find('input[name="PKG[]"]').val();
        console.log({
            productName: productName,
            batch: batchs,
            gstin: gstin,
            expdate: expdate,
            mrp: mrp,
            units: units,
            categoryName: categoryName,
            pkg: pkg
        });

        if (productName && batchs && gstin && expdate && mrp && units && categoryName && pkg && makename) {
            var lists = {
                pname: productName,
                batch: batchs,
                gstin: gstin,
                expdate: expdate,
                mrp: mrp,
                unitinkg: units,
                catname: categoryName,
                pkgs: pkg,
                make_product_name:makename
            };
            productlist.push(lists);
        } else {
            console.warn("Row " + index + " is missing data and will be skipped.");
        }
    });

    if (productlist.length > 0) {
        $.ajax({
            type: 'POST',
            url: './add_processes?formmode=add',
            contentType: 'application/json',
            data: JSON.stringify(productlist),
            success: function(response) {
                alert(response);
                 window.location.reload();
                // $("#alertmsg").text(response);
                // $('#alert').modal("toggle");
            },
            error: function(xhr, status, error) {
                console.error("AJAX error:", status, error);
                alert("An error occurred while sending the data.");
            }
        });
    } else {
        alert("No data to send.");
    }
} */
</script>
<style>
.spur-card-title {
	font-family: "Nunito", sans-serif;
	font-size: 25px;
}
</style>
<script>
document.addEventListener('DOMContentLoaded', function () {
    // Table 1
    const tableBody1 = document.getElementById('dynamicFieldsTable1').querySelector('tbody');
    // Table 2
    const tableBody2 = document.getElementById('dynamicFieldsTableex').querySelector('tbody');

    // Function to add a new row for Table 1
    function addRowToTable1() {
        const newRow = document.createElement('tr');
        newRow.innerHTML = `
            <td class="srl-no"></td> <!-- SRL No. will be updated -->
            <td style="width: 110px;">  <input type="text" name="itemCode" id="itemCode" onchange="product_name_typeFunction1(this)"
                style="width: 100%; text-align: center; " list="pronameList">
            <datalist id="pronameList">
                <option th:each="operator : \${rawmaterial}"
                    th:value="\${operator.itemCode + '-' + operator.itemName }"
                    th:text="\${operator.itemCode + '-' + operator.itemName}"></option>
            </datalist></td>
				
				<td><input type="text" name="itemname"
					id="itemname" 
					style="width: 100%;text-align:center;"> 
					
					<input type="hidden" name="category_name1"
						id="category_name1"
						style="width: 100%; text-align: center; ">
					
					</td>
					
				
					<td><input type="text" name="baseunit"
						id="baseunit"
						style="width: 100%; text-align: center; "></td>
						
						
						<td>
						<select style="width: 100%; text-align: center; " onchange="getprice(this);" name="batch">
						<option>Select</option>
						</select>
						</td>
							
						<td><input type="text" 
							 name="price" id="price"
							style="width: 100%; text-align: center; "></td>
							
							<td><input type="number" name="stock_qty" id="stock_qty"  style="width: 100%; text-align: center;" readonly></td>
	

					<td><input type="text" name="Quantity" oninput="boilcalculation(this)"
						id="Quantity" 
						style="width: 100%; text-align: center;"></td>
						
					<td><input type="text" name="Outtern"
						id="Outtern" oninput="boilcalculation(this)"
						style="width: 100%; text-align: center;"></td>	
						
					<td><input type="text" name="Kasadu"
						id="Kasadu"
						style="width: 100%; text-align: center;" readonly></td>
					
					<td><input type="text" name="Ghee"
						id="Ghee"
						style="width: 100%; text-align: center;" readonly></td>	
					
					<td style="text-align: center;">
				    <div style="display: flex; gap: 10px; justify-content: center; align-items: center;">
				        <span class="add-btnn" style="cursor: pointer; font-size: 20px; color: green;">
				            <i class="fas fa-plus add-btnn"></i>
				        </span>
				        
				        <span class="remove-btnn" style="cursor: pointer; font-size: 20px; color: red;">
				            <i class="fas fa-trash remove-btnn"></i>
				        </span>
				    </div>
				</td>	
					
            
							
        `;
        tableBody1.appendChild(newRow);
        updateSerialNumbers(tableBody1);
        //<td style="text-align: center;"><button class="btn btn-danger btn-sm remove-btnn">-</button></td>	
        
    }
		
    // Function to add a new row for Table 2
    function addRowToTable2() {
        const newRow = document.createElement('tr');
        newRow.innerHTML = `
            <td class="srl-no"></td> <!-- SRL No. will be updated -->
            <td>
                <input type="text" name="ExpensesType[]" id="ExpensesType" list="Expenseslist" style="width: 100%;">
                <datalist id="Expenseslist">
                    <option>Labour cost</option>
                    <option>Machinery cost</option>
                    <option>Electricity cost</option>
                    <option>Overhead cost</option>
                </datalist>
            </td>
            <td><input type="text" name="per/Amount[]" oninput="totalgheekasadu()" id="per/Amount" style="width: 100%;"></td>
        	<td style="text-align: center;">
		    <div style="display: flex; gap: 10px; justify-content: center; align-items: center;">
		        <span class="add-btnn" style="cursor: pointer; font-size: 20px; color: green;">
		            <i class="fas fa-plus add-btnn"></i>
		        </span>
		        
		        <span class="remove-btnn" style="cursor: pointer; font-size: 20px; color: red;">
		            <i class="fas fa-trash remove-btnn"></i>
		        </span>
		    </div>
		</td>	

           	
        `;
        tableBody2.appendChild(newRow);
        updateSerialNumbers(tableBody2);
        //<td style="text-align: center;"><button class="btn btn-danger btn-sm remove-btnn">-</button></td>		
    }

    // Function to update SRL No. for a table
    function updateSerialNumbers(tableBody) {
        const rows = tableBody.querySelectorAll('tr');
        rows.forEach((row, index) => {
            row.querySelector('.srl-no').textContent = index + 1; // Update SRL No.
        });
    }

    // Add event listener for the "Add" button in Table 1
     /*document.querySelector('.add-btnn').addEventListener('click', function (event) {
    	 event.preventDefault();
    	 const button = event.target; // Get the clicked button
    	    const row = button.closest('tr');
        addRowToTable1();
    });*/ 
    
    
     /*document.querySelector('.add-btnnn').addEventListener('click', function (event) {
    	 const button = event.target; // Get the clicked button
    	   event.preventDefault();
    	 const row = button.closest('tr');
        addRowToTable2();
    });*/ 

    // Add event listener for the "Add" button in Table 2
    tableBody2.addEventListener('click', function (event) {
        if (event.target.classList.contains('add-btnn')) {
            addRowToTable2();
        }
    });
    
   /*  ---table1 */
    tableBody1.addEventListener('click', function (event) {
        if (event.target.classList.contains('add-btnn')) {
            addRowToTable1();
        }
    });
    
    

    // Add event listener for removing a row in Table 1
    tableBody1.addEventListener('click', function (event) {
        if (event.target.classList.contains('remove-btnn')) {
            event.target.closest('tr').remove();
            updateSerialNumbers(tableBody1);// Update SRL No. after removing a row
            totalgheekasadu();
        }
    });

    // Add event listener for removing a row in Table 2
    tableBody2.addEventListener('click', function (event) {
        if (event.target.classList.contains('remove-btnn')) {
            event.target.closest('tr').remove();
            updateSerialNumbers(tableBody2); // Update SRL No. after removing a row
            totalgheekasadu();
        }
    });

    // Initial serial number setup for existing rows in both tables
    updateSerialNumbers(tableBody1);
    updateSerialNumbers(tableBody2);
});




</script>



<script type="text/javascript">

function dr(event){
	event.preventDefault();
	}

function addnewproduct(event) {
    event.preventDefault(); // Prevent default form submission

    var productlist = [];
    var isValid = true; // To track overall form validity
    var mandatoryMessage = "Please fill the required field(s)";
    var mfgProductName = $('#makingproductName').val().trim(); // Get the manufacturing product name
    
  

   
    
   if (!mfgProductName) {
       $('#makingproductName').css("border-color", "red").attr("title", mandatoryMessage);
       isValid = false;
   }

    // Function to validate a single field
    function validateField(field, errorMessage) {
        if (!field.val().trim()) {
            field.css("border-color", "red").attr("title", errorMessage);
            isValid = false;
        } else {
            field.css("border-color", "").attr("title", ""); // Reset styles
        }
    }

    // Validate each row in the first dynamic table
    $('#dynamicFieldsTable1 tbody tr').each(function (index) {
        var row = $(this);

        // Get field references
        var itemCode1 = row.find('input[name="itemCode"]');
        
        var splitfuntion = itemCode1.val().trim();
        var itemCode = splitfuntion ? splitfuntion.split('-')[0] : '';
     
        
        var itemName = row.find('input[name="itemname"]');
        var hsnCode = row.find('input[name="hsncode"]');
        var categoryName = row.find('input[name="category_name1"]');
        var baseUnit = row.find('input[name="baseunit"]');
        var qty = row.find('input[name="Quantity"]');
        
     

        // Validate fields in the row
        validateField(itemCode1, mandatoryMessage);
        validateField(qty, mandatoryMessage);

        // If the row is valid, add it to the product list
        if (isValid) {
            var product = {
                itemCode: itemCode,
                itemName: itemName.val().trim(),
                hsnCode: hsnCode.val().trim(),
                categoryName: categoryName.val().trim(),
                baseUnit: baseUnit.val().trim(),
                qty: qty.val().trim(),
                mfgProductName: mfgProductName
            };
            productlist.push(product);
        } else {
            console.warn("Row " + (index + 1) + " is missing data and will be skipped.");
        }
    });

    // Validate each row in the second dynamic table
    $('#dynamicFieldsTableex tbody tr').each(function (index) {
        var row = $(this);

        // Get field references
        var expensesType = row.find('input[name="ExpensesType[]"]');
        var amount = row.find('input[name="per/Amount[]"]');

        // Validate fields in the row
       /*  validateField(expensesType, mandatoryMessage);
        validateField(amount, mandatoryMessage); */

        // If the row is valid, add it to the product list
        if (expensesType.val().trim() !== "" && amount.val().trim() !== "") {
            var expense = {
                mfgProductName: mfgProductName,
                expensesType: expensesType.val().trim(),
                expensesCost: parseFloat(amount.val()).toFixed(2)
            };
            productlist.push(expense);
        }
        else {
            console.warn("Row " + (index + 1) + " in expenses is missing data and will be skipped.");
        }
            
         
    });

    // If any field is invalid, stop further processing
    if (!isValid) {
        alert(mandatoryMessage);
        return;
    }

    // AJAX Submission if product list is valid
    if (productlist.length > 0) {
        $.ajax({
            type: 'POST',
            url: './add_new_bom?formmode=add',
            contentType: 'application/json',
            data: JSON.stringify(productlist),
            success: function (response) {
            	 $("#alertmsg").text(response); // Display response in alertmsg
                 $("#alert").modal("toggle");
            	
          /*       alert(response); // Notify success
                window.location.reload(); // Reload the page to reflect changes */
            },
            error: function (xhr, status, error) {
                console.error("AJAX error:", status, error);
                alert("Product name already exists or an error occurred while sending the data.");
            }
        });
    } else {
        alert("No valid data to send. Please fill out the form correctly.");
    }
}


$(document).ready(function () {
    // Use event delegation for dynamically added fields
    $(document).on('input', '[name="itemCode"], [name="itemname"], [name="hsncode"], [name="category_name1"],[name="Quantity"], #makingproductName', function () {
        // Check if the field has a value and remove the error styling
        if ($(this).val().trim() !== "") {
            $(this).css("border-color", "");
        }
    });
});



</script>




<script>

function addmodifyproduct11111(event){
	
	
	 event.preventDefault(); // Prevent default form submission

	    var productlist = [];
	 
	 var bomid=document.getElementById('bomid').value;
	 
	 alert(bomid);
	    var mfgProductName = document.getElementById('makingproductName').value; // Get the manufacturing product name

	   

	    // Loop through each row in the dynamic table
	    $('#dynamicFieldsTable1 tbody tr').each(function(index) {
	        var row = $(this);

	        var itemCode = row.find('input[name="itemCode"]').val();
	        var itemName = row.find('input[name="itemname"]').val();
	        alert(itemName);
	        var hsnCode = row.find('input[name="hsncode"]').val();
	       
	        var categoryName = row.find('input[name="category_name1"]').val();
	        var baseUnit = row.find('input[name="baseunit"]').val();
	        var qty = row.find('input[name="Quantity"]').val();
	        
	        var refid = row.find('input[name="refid"]').val() || null;  
	        
	    
	      
	        
	        console.log({
	        	itemCode: itemCode,
	        	itemName: itemName,
	        	hsnCode: hsnCode,
	        	categoryName: categoryName,
	        	baseUnit: baseUnit,
	        	qty: qty,
	        	mfgProductName: mfgProductName
	        });
	        
	     
	        // Ensure all fields are filled before adding the product to the list
	        if (itemCode && itemName && hsnCode && categoryName && baseUnit && qty && mfgProductName &&bomid ) {
	            var lists = {
	            		bomId:bomid,
	            		id:refid,
	            		itemCode: itemCode,
	            		itemName: itemName,
	            		hsnCode: hsnCode,
	            		categoryName: categoryName,
	            		baseUnit: baseUnit,
	            		qty: qty,
	            		mfgProductName: mfgProductName
	               
	            };
	            productlist.push(lists);
	        } else {
	            console.warn("Row " + (index + 1) + " is missing data and will be skipped.");
	        }
	    });
	    
	    
	    $('#dynamicFieldsTableex tbody tr').each(function (index) {
		    var row = $(this);

		    var expensesType = row.find('input[name="ExpensesType[]"]').val();
		    var amount =parseFloat(row.find('input[name="per/Amount[]"]').val()).toFixed(2);
		    var refidexpen = row.find('input[name="refidexpen"]').val() || null;
			var list1={
					bomId:bomid,
					id:refidexpen,
					mfgProductName: mfgProductName,
					expensesType: expensesType,
					expensesCost: amount
			}
			
			productlist.push(list1);
		    console.log({
		    	makeProductName: mfgProductName,
		    	expensesType: expensesType,
		    	expensesCost: amount,
		    });
		    
		});
	    

	    
	    console.log("finall list" +productlist);
	    // If product list is not empty, send the data via AJAX
	    
	      if (productlist.length > 0) {
	    	
	    	console.log(productlist);
	        $.ajax({
	            type: 'POST',
	            url: './add_new_bom?formmode=edit',
	            contentType: 'application/json',
	            data: JSON.stringify(productlist),
	            success: function(response) {
	                alert(response); // Notify success
	                window.location.reload(); // Reload the page to reflect changes
	            },
	            error: function(xhr, status, error) {
	                console.error("AJAX error:", status, error);
	                alert("Product name already Exists or An error occurred while sending the data");
	            }
	        });
	    } else {
	        alert("No valid data to send. Please fill out the form correctly.");
	    }  
	}
	
	


</script>
<!-- ------new modify -->
<script>

function addmodifyproduct(event){

	
	event.preventDefault(); // Prevent default form submission

    var productlist = [];
	
    var bomid=document.getElementById('bomid').value;
    var isValid = true; // To track overall form validity
    var mandatoryMessage = "Please fill the required field(s)";
    var mfgProductName = $('#makingproductName').val().trim(); // Get the manufacturing product name

    // Validate Manufacturing Product Name
     if (!mfgProductName) {
	        $('#makingproductName').css("border-color", "red").attr("title", mandatoryMessage);
	        isValid = false;
	    }
  

    // Function to validate a single field
    function validateField(field, errorMessage) {
        if (!field.val().trim()) {
            field.css("border-color", "red").attr("title", errorMessage);
            isValid = false;
        } else {
            field.css("border-color", "").attr("title", ""); // Reset styles
        }
    }

    // Validate each row in the first dynamic table
    $('#dynamicFieldsTable1 tbody tr').each(function (index) {
        var row = $(this);

        // Get field references
        var itemCode = row.find('input[name="itemCode"]');
        var itemName = row.find('input[name="itemname"]');
        var hsnCode = row.find('input[name="hsncode"]');
        var categoryName = row.find('input[name="category_name1"]');
        var baseUnit = row.find('input[name="baseunit"]');
        var qty = row.find('input[name="Quantity"]');
        var refid = row.find('input[name="refid"]').val() || null;
        
     
        
     

        // Validate fields in the row
        validateField(itemCode, mandatoryMessage);
   
        validateField(qty, mandatoryMessage);

        // If the row is valid, add it to the product list
        if (isValid) {
        	var product = {
        		    bomId: bomid ? bomid.toString() : null, // Convert to string if necessary
        		    id: refid,
        		    itemCode: itemCode.val().trim(),
        		    itemName: itemName.val().trim(),
        		    hsnCode: hsnCode.val().trim(),
        		    categoryName: categoryName.val().trim(),
        		    baseUnit: baseUnit.val().trim(),
        		    qty: qty.val().trim(),
        		    mfgProductName: mfgProductName
        		};

            productlist.push(product);
        } else {
            console.warn("Row " + (index + 1) + " is missing data and will be skipped.");
        }
    });

    // Validate each row in the second dynamic table
    $('#dynamicFieldsTableex tbody tr').each(function (index) {
        var row = $(this);

        // Get field references
        var expensesType = row.find('input[name="ExpensesType[]"]');
        var amount = row.find('input[name="per/Amount[]"]');
        var refidexpen = row.find('input[name="refidexpen"]').val() || null;
        

        // Validate fields in the row
        //validateField(expensesType, mandatoryMessage);
        validateField(amount, mandatoryMessage);

        // If the row is valid, add it to the product list
        if (expensesType.val().trim() !== "" && amount.val().trim() !== "") {
            var expense = {
            		bomId:bomid,
					id:refidexpen,
                mfgProductName: mfgProductName,
                expensesType: expensesType.val().trim(),
                expensesCost: parseFloat(amount.val()).toFixed(2)
            };
            productlist.push(expense);
        } else {
            console.warn("Row " + (index + 1) + " in expenses is missing data and will be skipped.");
        }
    });

    // If any field is invalid, stop further processing
    if (!isValid) {
        alert(mandatoryMessage);
        return;
    }
    
    
    
    console.log("My ref console:", JSON.stringify(productlist, null, 2));


    // AJAX Submission if product list is valid
    if (productlist.length > 0) {
        $.ajax({
            type: 'POST',
            url: './add_new_bom?formmode=edit',
            contentType: 'application/json',
            data: JSON.stringify(productlist),
            success: function (response) {
            	 $("#alertmsg").text(response); // Display response in alertmsg
                 $("#alert").modal("toggle");
            	
          /*       alert(response); // Notify success
                window.location.reload(); // Reload the page to reflect changes */
            },
            error: function (xhr, status, error) {
                console.error("AJAX error:", status, error);
                alert("Product name already exists or an error occurred while sending the data.");
            }
        });
    } else {
        alert("No valid data to send. Please fill out the form correctly.");
    }
	
 
	}
	


</script>



<script>
function deleteProduct(a) {
    var makeproductname = a.getAttribute('data-makename'); // Get the data-id attribute value
    alert(makeproductname); // Optional: Show the ID for debugging

    $.ajax({
        type: 'POST',
        url: './delete_product?makeproductname=' + makeproductname, // Pass the product ID to the delete URL
        contentType: 'application/json',
        success: function(response) {
            alert(response); // Notify success
            window.location.reload(); // Reload the page to reflect changes
        },
        error: function(xhr, status, error) {
            console.error("AJAX error:", status, error);
            alert("An error occurred while deleting the product. Please try again.");
        }
    });
}


</script>
<script>

function makelist_fn(){
	 var makesname = document.getElementById("makesname").value; 
	 //alert(makesname)
	    $.ajax({
	        url: "./getmakeproduct?makesname=" + encodeURIComponent(makesname),
	        type: 'GET',
	        dataType: "json",
	        success: function(res) {
	        	const table = document.getElementById('dynamicFieldsTable').querySelector('tbody');
	        	const table1 = document.getElementById('dynamicFieldsTableex').querySelector('tbody');
	            // Clear the table before adding new rows
	            table.innerHTML = '';
	            table1.innerHTML='';

	            // Loop through the response to add rows dynamically
	            $.each(res, function(index, data) {
	                const values = Object.values(data);

	                // Create a new row
	                
	                //alert(values[0]);
	                if (values[0]!=null){
	                const newRow = document.createElement('tr');
	                newRow.innerHTML = `
	                    <td>
	                        <input type="text" name="product_name[]" value="${values[0]}" list="pronameList" onchange="product_name_typeFunction1(this)" style="width: 100%;">
	                        <datalist id="pronameList">
	                            <option th:each="operator : \${productList}" th:value="\${operator.PRODUCT_NAME}" th:text="\${operator.PRODUCT_NAME}"></option>
	                        </datalist>
	                    </td>
	                    <td>
	                        <select id="BATCH" name="batch[]" onchange="getcurrentstock(this)" style="width: 100%;">
	                            <option value="${values[1]}">${values[1]}</option>
	                        </select>
	                    </td>
	                    <td>
	                        <input type="text" name="UNITS[]" value="${values[2]}" style="width: 100%;" readonly>
	                    </td>
	                    <td>
	                        <input type="text" name="category_name1[]" value="${values[3]}" style="width: 100%;">
	                    </td>
	                    <td>
	                        <input type="text" name="PKG[]" value="${values[4]}" style="width: 100%;" readonly>
	                    </td>
	                    <td>
	                        <input type="text" name="qty[]" value="" style="width: 100%;">
	                    </td>
	                    <td>
	                        <button type="button" class="btn btn-danger remove-btn">Remove</button>
	                    </td>
	                `;
	                
	                // Append the new row to the table
	                var batch =newRow.querySelector('[name="batch[]"]');
	                getcurrentstock(batch);
	                table.appendChild(newRow);
	                }
	                else{
	                	const newRow = document.createElement('tr');
	                	newRow.innerHTML =`	
	                	<td>
	                    <input type="text" name="ExpensesType[]" id="ExpensesType" value="${values[6]}" style="width: 100%;">
	                    
	                </td>
	                <td><input type="text" name="per/Amount[]" id="per/Amount" value="${values[7]}" style="width: 100%;"></td>
	                <td style="text-align:center"><button type="button"  class="btn btn-danger remove-btnn" >Remove</button></td>`;
	                table1.appendChild(newRow)
	                }
	                
	                

	        		 document.getElementById('makingproductName').value=values[5];
	            });

	        }
	    });
	
}



</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Add event listener after the DOM has fully loaded
    document.getElementById('kilograms').addEventListener('input', function ()  {
        //alert('Input event triggered'); // This alert should show when typing in the "kilograms" field
        
        // Get the entered value in the kilograms input
        var orderKgs = parseFloat(this.value);


        // Check if a valid number is entered
        if (isNaN(orderKgs)) {
            return; // Exit if no valid number
        }

        // Get all rows in the table
        var tableRows = document.querySelectorAll('#dynamicFieldsTable tbody tr');

        tableRows.forEach(function(row) {
            // Get the "kgs" value for each row using the name attribute selector
            var kgsValue = parseFloat(row.querySelector('[name="PKG[]"]').value);
            var unit =parseFloat(row.querySelector('[name="UNITS[]"]').value);
            var product_name =row.querySelector('[name="product_name[]"]').value;
            // If the kgsValue is a valid number, multiply it with the orderKgs and update the quantity field
            if (!isNaN(kgsValue)) {
                var calculatedQty = orderKgs * kgsValue;
                if(calculatedQty>unit){
                	alert("please check current stock of "+product_name);
                	row.querySelector('[name="qty[]"]').value ="";
                	
                }
                else{
                // Set the value of the quantity field in the same row
                row.querySelector('[name="qty[]"]').value = calculatedQty.toFixed(2); // Fixed to 2 decimal places
                }
                }
        });
    });
});

function n(){
	var orderNos = document.getElementById('kilograms').value;
	var tableRows = document.querySelectorAll('#dynamicFieldsTable tbody tr');

    tableRows.forEach(function(row) {
        // Get the "kgs" value for each row using the name attribute selector
        var kgsValue = parseFloat(row.querySelector('[name="PKG[]"]').value);
        var unit =parseFloat(row.querySelector('[name="UNITS[]"]').value);
        var product_name =row.querySelector('[name="product_name[]"]').value;
        //alert(product_name);

        // If the kgsValue is a valid number, multiply it with the orderKgs and update the quantity field
        if (!isNaN(kgsValue)) {
            var calculatedQty = orderNos * kgsValue;
            if(calculatedQty>unit){
            	alert("please check current stock of "+product_name);
            }
            else{

            // Set the value of the quantity field in the same row
            row.querySelector('[name="qty[]"]').value = calculatedQty.toFixed(2); // Fixed to 2 decimal places
            }
        }
        
    });

	
}

</script>

<script type="text/javascript">

function addTaxData(event) {
    event.preventDefault(); // Prevent the default form submission

    var productlist = [];
    var makename = document.getElementById('makingproductName').value;
    var orderNos = document.getElementById('kilograms').value;
    var woid = document.getElementById('woid').value;
    //alert(makename); 
    //alert(orderNos); 
    $('#dynamicFieldsTable tbody tr').each(function(index) {
        var row = $(this);
        console.log("Processing row " + index);
        console.log(row.html());  // Log the HTML of the current row to check its structure

        var productName = row.find('input[name="product_name[]"]').val();
        var batchs = row.find('select[name="batch[]"]').val();
        var units = row.find('input[name="UNITS[]"]').val();
        var categoryName = row.find('input[name="category_name1[]"]').val();
        var pkg = row.find('input[name="PKG[]"]').val();
        var quantity = row.find('input[name="qty[]"]').val();
        console.log({
            productName: productName,
            batch: batchs,
            units: units,
            categoryName: categoryName,
            pkg: pkg,
            qty:quantity
        });

        if (productName && batchs && units && categoryName && pkg && makename && orderNos && quantity) {
            var lists = {
                pname: productName,
                batch: batchs,
                unitinkg: units,
                catname: categoryName,
                pkgs: pkg,
                qty: quantity,
                kilograms: orderNos,
                make_product_name:makename
            };
            productlist.push(lists);
        } else {
            console.warn("Row " + index + " is missing data and will be skipped.");
        }
    });

    if (productlist.length > 0) {
        $.ajax({
            type: 'POST',
            url: './add_processes?formmode=add&woid='+woid,
            contentType: 'application/json',
            data: JSON.stringify(productlist),
            success: function(response) {
                alert(response);
                 window.location.reload();
                // $("#alertmsg").text(response);
                // $('#alert').modal("toggle");
            },
            error: function(xhr, status, error) {
                console.error("AJAX error:", status, error);
                alert("An error occurred while sending the data.");
            }
        });
    } else {
        alert("No data to send.");
    }
}
//Function to read the options from the 'makelist' datalist
function readMakelistOptions() {
    const datalist = document.getElementById('makelist'); // Get the datalist element
    const options = datalist.querySelectorAll('option');// Get all options inside the datalist
    const woid =document.getElementById('woid').value;
    const makesname =document.getElementById('makesname');
    const kilograms=document.getElementById('kilograms');
    
    //alert(woid);
 // Create an array to store the option values
    const makelistValues = [];
    var makename="";
    $.ajax({
        type: 'GET',
        url: './getWO?woid='+woid,
        success: function(response) {
            //alert(response.item);
            options.forEach(option => {
                makelistValues.push(option.value);// You can also use option.text if you want the text
                if(response.item==option.value){
                	makename=option.value;
                	//alert(makename);	
                }   
            });
            if (makename!=""){
            makesname.value=makename;
        	makelist_fn();
        	kilograms.value=response.qty;
        	setTimeout(n,3000);
            }
            else{
            	alert("please Add New product");
            	location.reload();
            }
           
        },
        error: function(xhr, status, error) {
            console.error("AJAX error:", status, error);
            alert("An error occurred while sending the data.");
        }
    });
    
        
    // Loop through the options and add their values to the array
    
    
    console.log(makelistValues); // Output the array to the console or process further
}

function totalcl(){
	var peramount=document.getElementById('per/Amount').value;
	var qnt=document.getElementById('Quantity').value;
	var qnt=document.getElementById('TotalAmount');
	alert(peramount);
}

</script>


<script>
function viewbom(a) {
    var bomId1 = a.getAttribute('data-bom');
    location.href = './BillOfMaterial?formmode=view&bomId=' + bomId1;
}


function modifyforbom(a){
	     var bomId1 = a.getAttribute('data-bom');
	     location.href = './BillOfMaterial?formmode=modify&bomId=' + bomId1;
}
				
function deleteviewforbom(a){
	 var bomId1 = a.getAttribute('data-bom');
	 location.href = './BillOfMaterial?formmode=delete&bomId=' + bomId1;
}




function deletebom(a) {
	 var bomId1 = a.getAttribute('data-bom');
	 
	
    // Show the confirmation modal
    $('#confirmationModal').modal('show');

    // When the user clicks the "Yes, Delete" button
    $('#confirmDeleteBtn').on('click', function() {
        $.ajax({
            url: './deletebom?bomId=' + bomId1,
            type: 'POST',
            success: function(response) {
                $("#alertmsg").text(response); // Display response in alertmsg
                $("#alert").modal("toggle"); // Show success alert modal
                $('#confirmationModal').modal('hide'); // Close the confirmation modal
            },
            error: function(xhr, status, error) {
                alert("Error: " + error); // Handle error
                $('#confirmationModal').modal('hide'); // Close the confirmation modal on error
            }
        });
    });
}


</script>

<script>

function searchTable(tableId, searchInputId) {
    var input = $('#' + searchInputId).val().toUpperCase();
    var $table = $('#' + tableId + ' tbody');
    var rows = $table.find('tr');

    rows.each(function () {
        var cells = $(this).find('td');
        var found = false;

        cells.each(function () {
            if ($(this).text().toUpperCase().indexOf(input) > -1) {
                found = true;
                return false; // Exit loop early
            }
        });

        if (found) {
            $(this).show();
        } else {
            $(this).hide();
        }
    });
}



$(document).ready(function () {
    $('#dynamicFieldsTablelist').DataTable({
        "pageLength": 20,        // Set the number of rows per page
        "lengthChange": false,   // Hide the dropdown for changing rows per page
        "ordering": false,       // Disable column sorting
        "searching": true,       // Enable global search
        "info": true,            // Show table information
        "pagingType": "simple_numbers", // Pagination with only numbers

        // Customizing DOM structure to place search box at the top left

        "dom": '<"top"f>rt<"bottom"ip><"clear">'
    });

    // Remove the "Search:" label and add a placeholder to the search input
    $('.dataTables_filter label').contents().filter(function () {
        return this.nodeType === Node.TEXT_NODE;
    }).remove(); // Remove the text node containing "Search:"

    // Add a placeholder to the input field
    $('.dataTables_filter input')
        .attr('placeholder', 'Search...')
        .css('margin-left', '0'); // Adjust margin since the label is removed

    // Align the search box to the left corner
    $('.dataTables_filter').css({
        "float": "left",
        "text-align": "left"
    });
});








</script>

<script>
		function capitalizeInput(input) {
			let value = input.value;
			// Only change the first letter to uppercase if it's lowercase
			value = value.replace(/\b[a-z]/g, function (char) {
				return char.toUpperCase();
			});
			input.value = value;
		}
		
		function listpage(event){
			
			event.preventDefault();
			location.href='./BillOfMaterial?formmode=history'
		}
		function addpage(event){
			event.preventDefault();
			location.href='./BillOfMaterial'
		}
	</script>
	

<script>

function boilcalculation(input){
	
	 const row = input.closest('tr');
	 var itemname=row.querySelector('input[name="itemname"]').value;
	 var Quantity=parseFloat(row.querySelector('input[name="Quantity"]').value);
	 var Outtern=row.querySelector('input[name="Outtern"]').value;
	 var Kasadu=row.querySelector('input[name="Kasadu"]').value;
	 var Ghee=row.querySelector('input[name="Ghee"]').value;
	 var stock_qty=parseFloat(row.querySelector('input[name="stock_qty"]').value);
	 var kasaducal=0;
	 var gheereturn=0;
	 
	 //alert(itemname);
	 let itemnamecleaned = itemname.trim().replace(/\s+/g, "") 
	 let itemnameuppercase = itemnamecleaned.toUpperCase();
	 row.querySelector('input[name="Kasadu"]').value=0;
	 row.querySelector('input[name="Ghee"]').value=0;
	 //alert(stock_qty)
	 
	 if(stock_qty>=Quantity){
	 if(itemnameuppercase=='YELLOWBUTTER'||itemnameuppercase=='YELLOWBOX'||itemnameuppercase=='WHITEBUTTER'||itemnameuppercase=='WHITEBOX'){
		 row.querySelector('input[name="Kasadu"]').value=0;
		 row.querySelector('input[name="Ghee"]').value=0;
		 kasaducal=Quantity/100*2;
		 row.querySelector('input[name="Kasadu"]').value=kasaducal;
		 var gheet=Outtern-2;
		 gheereturn=gheet/100*Quantity;
		
		 row.querySelector('input[name="Ghee"]').value=gheereturn.toFixed(2);	 
	 }
	 
	 else if(itemnameuppercase=='YELLOWCREAM'||itemnameuppercase=='WHITECREAM'){
		 row.querySelector('input[name="Kasadu"]').value=0;
		 row.querySelector('input[name="Ghee"]').value=0;
		 kasaducal=Quantity/100*5;
		 row.querySelector('input[name="Kasadu"]').value=kasaducal;
		 var gheets=Outtern-5;
		 gheereturn=gheets/100*Quantity;
		 row.querySelector('input[name="Ghee"]').value=gheereturn.toFixed(2);	
	 }
	 else if(itemnameuppercase=='GHEETINE'){
		 row.querySelector('input[name="Kasadu"]').value=0;
		 row.querySelector('input[name="Ghee"]').value=0;
		 var gheetin=Quantity*15
		 row.querySelector('input[name="Ghee"]').value=gheetin.toFixed(2);
		 row.querySelector('input[name="Outtern"]').value=0;
	 }
	 
	 else if(itemnameuppercase=='LOOSEGHEE'){
		 row.querySelector('input[name="Kasadu"]').value=0;
		 row.querySelector('input[name="Ghee"]').value=0;
		 row.querySelector('input[name="Outtern"]').value=0;
		 row.querySelector('input[name="Ghee"]').value=Quantity.toFixed(2);
		 
	 }
	 
	 }else if(stock_qty<Quantity){
		 alert("Please Check stock");
		 row.querySelector('input[name="Kasadu"]').value=0;
		 row.querySelector('input[name="Ghee"]').value=0;
		 row.querySelector('input[name="Quantity"]').value="";
		 
	 }
	 totalgheekasadu();
}


function totalgheekasadu() {
    var totalghee = 0;
    var totalkasadu = 0;
    var totalcost = 0;
    var totalexpenses=0;
    

    $('#dynamicFieldsTable1 tbody tr').each(function(index) {
        var row = $(this);

        var Kasadu = parseFloat(row.find('input[name="Kasadu"]').val()) || 0;
        var Ghee = parseFloat(row.find('input[name="Ghee"]').val()) || 0;
        var Quantity = parseFloat(row.find('input[name="Quantity"]').val()) || 0;
        var price = parseFloat(row.find('input[name="price"]').val()) || 0;
        totalcost+=Quantity*price
        totalkasadu += Kasadu;
        totalghee += Ghee;
    });
    
    $('#dynamicFieldsTableex tbody tr').each(function(index) {
        var row = $(this);
        var expensesamount = parseFloat(row.find('input[name="per/Amount[]"]').val()) || 0;
        totalexpenses+=expensesamount;
        
    
    });
    
    

    document.getElementById('KasaduReceived').value = totalkasadu.toFixed(2);
    document.getElementById('GheeReceived').value = totalghee.toFixed(2);
    document.getElementById('Materialtotal').value = totalcost.toFixed(2);
    document.getElementById('Expensesgrandtotal').value = totalexpenses.toFixed(2);
    
    
}



</script>

<script type="text/javascript">
function add_process(event) {
    event.preventDefault();

    let validationtest = true;
    let productlist = [];

    const branchId = document.getElementById('branchId').value.trim();
    const KasaduReceived = parseFloat(document.getElementById('KasaduReceived').value) || 0;
    const GheeReceived = document.getElementById('GheeReceived').value.trim() || "0";
    const Materialtotal = parseFloat(document.getElementById('Materialtotal').value) || 0;
    const Expensesgrandtotal = parseFloat(document.getElementById('Expensesgrandtotal').value) || 0;

    const grantTotal = Materialtotal + Expensesgrandtotal;

    // Reset previous validation styles
    $('#branchId').css("border-color", "").removeAttr("title");

    // Validation
    let isValid = true;
    const mandatoryMessage = "Please fill the required field(s)";
    if (!branchId) {
        $('#branchId').css("border-color", "red").attr("title", mandatoryMessage);
        isValid = false;
    }

    if (!isValid) {
        alert(mandatoryMessage);
        return;
    }

    // Table 1 Data Collection
    $('#dynamicFieldsTable1 tbody tr').each(function () {
        const row = $(this);

        const itemCode1 = row.find('input[name="itemCode"]').val()?.trim() || "";
        const itemCode = itemCode1.split('-')[0] || "";

        const itemname = row.find('input[name="itemname"]').val() || "";
        const category_name1 = row.find('input[name="category_name1"]').val() || "";
        const baseunit = row.find('input[name="baseunit"]').val() || "";
        const batch = row.find('select[name="batch"]').val();
        const price = parseFloat(row.find('input[name="price"]').val()) || 0;
        const stock_qty = parseFloat(row.find('input[name="stock_qty"]').val()) || 0;
        const qty = parseFloat(row.find('input[name="Quantity"]').val()) || 0;
        const Outtern = parseFloat(row.find('input[name="Outtern"]').val()) || 0;
        const Kasadu = parseFloat(row.find('input[name="Kasadu"]').val()) || 0;
        const Ghee = parseFloat(row.find('input[name="Ghee"]').val()) || 0;
        var totalprice=qty*price;

        if (batch) {
            productlist.push({
                branchId: branchId,
                itemCode: itemCode,
                itemname: itemname,
                category_name1: category_name1,
                baseunit: baseunit,
                batch: batch,
                price: price,
                stock_qty: stock_qty,
                quantity: qty,
                reqqnt: qty,
                kilograms:GheeReceived,
                units:'kg',
                outtern: Outtern,
                kasadu: Kasadu,
                ghee: Ghee,
                totalkasadu: KasaduReceived,
                totalghee: GheeReceived,
                materialtotalvalue: Materialtotal,
                expensesgrandtotal: Expensesgrandtotal,
                grantTotal: grantTotal,
                makingproductName: 'Ghee',
                totalprice:totalprice
            });
        } else {
            validationtest = false;
        }
    });

    // Table 2 Data Collection
    $('#dynamicFieldsTableex tbody tr').each(function () {
        const row = $(this);

        const expensesType = row.find('input[name="ExpensesType[]"]').val()?.trim() || "";
        const amount = parseFloat(row.find('input[name="per/Amount[]"]').val()) || 0;

        if (expensesType && amount > 0) {
            productlist.push({
                branchId: branchId,
                expensesCost: amount.toFixed(2),
                expensestype: expensesType
            });
        }
    });

    if (productlist.length > 0 && validationtest === true) {
        $.ajax({
            type: 'POST',
            url: './add_boil_process_tsk?formmode=add',
            contentType: 'application/json',
            data: JSON.stringify(productlist),
            success: function (response) {
                $("#alertmsg").text(response);
                $("#alert").modal("toggle");
                // window.location.reload();
            },
            error: function (xhr, status, error) {
                console.error("AJAX error:", status, error);
                alert("An error occurred while sending the data.");
            }
        });
    } else {
        alert("No data to send or some rows have missing batch values.");
    }
}

// Reset border color on user input
$(document).ready(function () {
    $('#branchId').on('input', function () {
        $(this).css("border-color", "");
    });
});


</script>



<body>

	<div class="container-fluid">

		<div class="row">
			<!-- sideMenu -->

			<div class="col-lg-2">
				<div th:insert="BTMHeaderMenu :: header"></div>
			</div>
			<div class="col-sm-12">
				<div class="container-fluid content" th:if="${formmode}=='add'">
					<div class="row">
						<!-- Form for Journal Entry -->
						<form action="#" method="post" class="w-100"
							id="VendorRegistrationadd" autocomplete="off">
					<div class="card ">
					
					<div class="card-header d-flex justify-content-between align-items-center" style="font-family: 'Nunito', sans-serif; font-size: 1.5rem; font-weight: bold; color: black; padding-left:20px">
        				<div STYLE="font-size: 1.3rem;">Boil</div>
        				<div>
		        				<button class="btn btn-light btn-sm" onclick="listpage(event);" style="color: black; font-weight: bold; border-color: black;">
		                			<i class="fas fa-list mr-1"></i> List
		            			</button>
						</div>
					</div>
					
					<br>
					<!-- Table -->
					<div class="">
						<div class="col-lg-12" style="margin-top:-15px;">
							
								<div class="table-responsive"
										style="overflow-y: auto; overflow-x: hidden; max-height: 85vh; border: 1px solid #dee2e6;">
								<br>		
								<div class="container-fluid">
									<div class="row">
										<div class="col-lg-12"></div>
										<div class="form-group col-md-auto">
								<label for="branchId" class="form-legend"> Branch Id:</label></div>
                                  <div class="form-group col-md-2">
										<div class="form-floating">
											<select class="form-control" id="branchId" name="branchId">
												<option value="">Select Branch</option>
												<!-- Populate options dynamically using Thymeleaf -->
												<option th:each="branchId : ${branchIds}"
													th:value="${branchId}" th:text="${branchId}"></option>
											</select>
										</div>
									</div>
									</div>
									<!-- Table -->

									<div class="row">
										<div class="col-lg-12">
										
												<form method="post" autocomplete="off" id="addStockHistory"
													th:fragment="finuserapply">

													<div class="card-body" style="padding: 10px;">
														<table id="dynamicFieldsTable1"
															class="table table-bordered">
															<thead>
																<tr>
																	<th>SNo.</th>
																	<th style="width: 13%;">Item Code</th>
																	<th style="width: 15%;">Item Name</th>
																	<th style="width: 10%;">Base Unit</th>
																	<th style="width: 10%;">Batch</th>
																	<th>price</th>
																	<th>Stock</th>
																	<th>Qty/Unit</th>
																	<th>Outtern</th>
																	<th>Kasadu</th>
																	<th>Ghee</th>
																	<th>Action</th>

																</tr>
															</thead>
															<tbody>
																<tr>
																	<td class="srl-no">1</td>

																	<td style="width: 110px;"><input type="text"
																		name="itemCode"
																		onchange="product_name_typeFunction1(this)"
																		id="itemCode"
																		style="width: 100%; text-align: center; "
																		list="pronameList"> <datalist id="pronameList">
																			<option value="Loose Ghee">Loose Ghee</option>
																			<option th:each="operator : ${rawmaterial}"
																				th:value="${operator.itemCode +'-' + operator.itemName }"
																				th:text="${operator.itemCode + '-' + operator.itemName}"></option>
																		</datalist></td>

																	<td><input type="text" name="itemname"
																		id="itemname"
																		style="width: 100%; text-align: center; ">
																		<input type="hidden" name="category_name1"
																		id="category_name1"
																		style="width: 100%; text-align: center; ">
																		
																		</td>
																		
																	<td><input type="text" name="baseunit"
																		id="baseunit"
																		style="width: 100%; text-align: center; "></td>		
																	
																	<td>
																	<select style="width: 100%; text-align: center; " onchange="getprice(this);" name="batch">
																	<option>Select</option>
																	</select>
																	</td>
																		
																	<td><input type="text" 
																		 name="price" id="price"
																		style="width: 100%; text-align: center; "></td>
																		
																		<td><input type="number" name="stock_qty" id="stock_qty"  style="width: 100%; text-align: center;" readonly></td>
																		

																	<td><input type="text" name="Quantity"
																		id="Quantity" oninput="boilcalculation(this)"
																		style="width: 100%; text-align: center;"></td>
																		
																	<td><input type="text" name="Outtern"
																		id="Outtern" oninput="boilcalculation(this)"
																		style="width: 100%; text-align: center;"></td>	
																		
																	<td><input type="text" name="Kasadu"
																		id="Kasadu"
																		style="width: 100%; text-align: center;" readonly></td>
																	
																	<td><input type="text" name="Ghee"
																		id="Ghee"
																		style="width: 100%; text-align: center;" readonly></td>				


																	<td style="text-align: center;">
																	    <div style="display: flex; gap: 10px; justify-content: center; align-items: center;">
																	        <!-- Plus icon -->
																	        <span class="add-btnn" style="cursor: pointer; font-size: 20px; color: green;">
																	            <i class="fas fa-plus add-btnn"></i>
																	        </span>
																	        
																	        <!-- Trash (delete) icon -->
																	        <span class="remove-btnn" style="cursor: pointer; font-size: 20px; color: red;">
																	            <i class="fas fa-trash remove-btnn"></i>
																	        </span>
																	    </div>
																	</td>
																																		

																	<!--<td><button type="button"
																			class="btn btn-success add-btnn">Add</button></td>-->
																</tr>
															</tbody>
														</table>
														<!--<button style ="width:35px; margin-top:-24px"  class="btn btn-dark add-btnn">+</button>-->
														<div></div>
														<br>

														<div class="card-header"
															style="font-family: 'Nunito', sans-serif; font-size: 23px; font-weight: 600; padding: 1.7rem;">

															<div class="float-left">
																<h6 style="font-size: 1.5rem; color: black;">Other
																	Expenses</h6>
															</div>


														</div>



														<table id="dynamicFieldsTableex"
															class="table table-bordered">
															<thead>
																<tr>
																	<th>SNo.</th>
																	<th>Expenses Type</th>
																	<th>Expenses cost</th>
																	<th>Actions</th>
																</tr>
															</thead>
															<tbody>
																<tr>
																	<td class="srl-no">1</td>
																	<td><input type="text" name="ExpensesType[]"
																		id="ExpensesType" list="Expenseslist"
																		style="width: 100%; "> <datalist
																			id="Expenseslist">
																			<option>Labour cost</option>
																			<option>Machinary cost</option>
																			<option>Electricity cost</option>
																			<option>Overhead cost</option>
																		</datalist></td>


																	<td><input type="text" name="per/Amount[]"
																		id="per/Amount" oninput="totalgheekasadu()"
																		style="width: 100%;"></td>

																	<!--<td style="text-align: center; vertical-align: middle;"><button type="button" 
																			class="btn btn-success add-btnn">Add</button></td>-->
																	<!--<td style="text-align: center;"><button class="btn btn-danger btn-sm remove-btnn">-</button></td>-->
																	<td style="text-align: center;">
																	    <div style="display: flex; gap: 10px; justify-content: center; align-items: center;">
																	        <!-- Plus icon -->
																	        <span class="add-btnn" style="cursor: pointer; font-size: 20px; color: green;">
																	            <i class="fas fa-plus add-btnn"></i>
																	        </span>
																	        
																	        <!-- Trash (delete) icon -->
																	        <span class="remove-btnn" style="cursor: pointer; font-size: 20px; color: red;">
																	            <i class="fas fa-trash remove-btnn"></i>
																	        </span>
																	    </div>
																	</td>			
																</tr>
															</tbody>
														</table>
														<!--<button style ="width:35px; margin-top:-24px"  class="btn btn-dark btn-success">+</button>
														<div></div>
														<br>-->


														<div class="form-row align-items-center">
															<div class="form-group col-md-1">
																<label for="productName">Total Ghee:</label>
															</div>
															<div class="form-group col-md-2">
																<input type="text" class="form-control"
																	id="GheeReceived" placeholder="Ghee"
																	style="border-color: #333333;"
																	required readonly>
															</div>
															
															<div class="form-group col-md-1">
																<label for="productName">Total Kasadu:</label>
															</div>
															<div class="form-group col-md-2">
																<input type="text" class="form-control"
																	id="KasaduReceived" placeholder="Kasadu"
																	style="border-color: #333333;" 
																	required readonly>
															</div>
															
															<div class="form-group col-md-1">
																<label for="productName">Material Cost:</label>
															</div>
															<div class="form-group col-md-2">
																<input type="text" class="form-control"
																	id="Materialtotal" placeholder="Material Cost"
																	style="border-color: #333333;" 
																	required readonly>
															</div>
															
															<div class="form-group col-md-1">
																<label for="productName">Expenses Cost:</label>
															</div>
															<div class="form-group col-md-2">
																<input type="text" class="form-control"
																	id="Expensesgrandtotal" placeholder="Expenses Cost"
																	style="border-color: #333333;" 
																	required readonly>
															</div>
															
														</div>


													</div>
												</form>
											</div>
										</div>
									</div>
									</div>


								
								<br>

								<div class="card-footer text-center"
									style="font-family: 'Nunito', sans-serif; margin-top:-20px; font-size: 23px; font-weight: 600;">

									<button class="btn btn-xs btn-dark" type="button"
										id="Dashboard" onclick="contentLoad(this)">Home</button>
									<button class="btn btn-xs btn-dark" id="btnSubmit"
										onclick="add_process(event);">Submit</button>
									<button class="btn btn-xs btn-dark" type="button" id="btnBack"
										onclick="back();">Back</button>

								</div>




							
						</div>
					</div>
				</div>
				</form>
				</div>
				</div>

				<!-- ------history--- -->


				<div class="container-fluid content" th:if="${formmode}=='history'">
				<div class="row">
						
						<form action="#" method="post" class="w-100"
							id="VendorRegistrationadd" autocomplete="off">
				<div class="card ">
					<div class="card-header d-flex justify-content-between align-items-center" style="font-family: 'Nunito', sans-serif; font-size: 1.5rem; font-weight: bold; color: black; padding-left:20px">
        				<div STYLE="font-size: 1.3rem;"><i class="fas fa-list mr-1"></i>Bill Of Material-List</div>
        				<div>	
		            			<button class="btn btn-light btn-sm"  style="color: black; font-weight: bold; border-color: black;" onclick="addpage(event);"><i class="fas fa-user-plus mr-2"></i>Add</button>
						</div>
					</div>
					
				
					
					<br>
					<!-- Table -->
					<div class="row">
						<div class="col-lg-12">
							
							
					

								<div class="container-fluid">
									<div class="row">
									<!-- 	<div class="col-lg-12" >
												<div class="mb-3 d-flex justify-content-between align-items-center" style="margin-top: 10px">
											<div>
												<input type="text" id="searchInput" placeholder="Search..."
													onkeyup="searchTable('dynamicFieldsTablelist', 'searchInput')" class="form-control" />
											</div>
											
										</div>
										
										</div> -->
									</div>
									<!-- Table -->

									<div class="row">
										<div class="col-lg-12">
											<div class="card " style="margin-top: 2px">
												<form method="post" autocomplete="off" id="addStockHistory"
													th:fragment="finuserapply">
													
													<div class="table-responsive" style="overflow-y: auto; height: 85vh; border: 1px solid #dee2e6;">

													<div class="card-body" style="padding: 10px;">
														<table id="dynamicFieldsTablelist"
															class="table table-bordered">
															<thead>
																<tr>
																	<th style="text-align:left;">ID</th>
																	<th style="text-align:left;">Item Code</th>
																	<th style="text-align:left;">Item Name</th>
																	<th style="text-align:left;">HSN Code</th>
																	<th style="text-align:left;">Category Name</th>

																	<th style="text-align:left;">Base Unit</th>

																	<th style="text-align:right;">Qty</th>
																	<th>Action</th>

																</tr>
															</thead>
															<tbody>
																<tr th:each="bomdetails : ${bomdetails}">
																	<td style="text-align: left;"
																		th:text="${bomdetails.bomId}"></td>
																	<td style="text-align: left;"
																		th:text="${bomdetails.itemCode}"></td>
																	<td style="text-align: left;"
																		th:text="${bomdetails.itemName}"></td>
																	<td style="text-align: left;"
																		th:text="${bomdetails.hsnCode}"></td>
																	<td style="text-align: left;"
																		th:text="${bomdetails.categoryName}"></td>
																	<td style="text-align: left;"
																		th:text="${bomdetails.baseUnit}"></td>
																	<td style="text-align: right;"
																		th:text="${#numbers.formatDecimal(bomdetails.qty,1,3)}"></td>
																	<td style="text-align: center;">


																		<div class="dropdown" style="text-align: center;">
																			<button class="btn btn-secondary dropdown-toggle"
																				type="button" id="dropdownMenuButton" title="Action"
																				style="line-height: 0.7; font-size: 13px; color: #3a4550; background: #e3e3e4;"
																				data-toggle="dropdown" aria-haspopup="true"
																				aria-expanded="false">Action</button>

																			<div class="dropdown-menu"
																				aria-labelledby="dropdownMenuButton"
																				style="background-color: #e3e3e4; color: #3a4550;">


																				<a class="dropdown-item" title=" Modify"
																					style="cursor: pointer;"
																					th:attr="data-bom=${bomdetails.bomId}"
																					onclick="modifyforbom(this)">Modify</a> <a
																					class="dropdown-item" title=" view"
																					th:attr="data-bom=${bomdetails.bomId}"
																					style="cursor: pointer;" onclick="viewbom(this)">View</a>

																				<a class="dropdown-item" title=" delete"
																					th:attr="data-bom=${bomdetails.bomId}"
																					style="cursor: pointer;"
																					onclick="deleteviewforbom(this)">Delete</a>

																			</div>
																		</div>



																	</td>

																</tr>
															</tbody>
														</table>










													</div>
													</div>
												</form>
											</div>
										</div>
									</div>


								</div>


								<div class="card-footer text-center"
									style="font-family: 'Nunito', sans-serif; font-size: 23px; font-weight: 600;">

									<button class="btn btn-xs btn-dark" type="button"
										id="Dashboard" onclick="contentLoad(this)">Home</button>

									<button class="btn btn-xs btn-dark" type="button" id="btnBack"
										onclick="back();">Back</button>

								</div>
							</div>

						</div>
					</div>
					</form>
				</div>
				</div>
				



				<!-- 	--------view-------- -->

				<div class="container-fluid content" th:if="${formmode}=='view'">
					<div class="row">
						
						<form action="#" method="post" class="w-100"
							id="VendorRegistrationadd" autocomplete="off">
					<div class="card ">
					
					<div th:if="${deleteoption=='view'}" class="card-header d-flex justify-content-between align-items-center" style="font-family: 'Nunito', sans-serif; font-size: 1.5rem; font-weight: bold; color: black;">
        				<div STYLE="font-size: 1.3rem;">Bill Of Material-View<span
								th:text="${'('+bomdetails[0].bomId+')'}"></span> <input
								type="hidden" id="bomid" th:value="${bomdetails[0].bomId}" /></div>
        				<div>
		        				<button class="btn btn-light btn-sm" onclick="listpage(event);" style="color: black; font-weight: bold; border-color: black;">
		                			<i class="fas fa-list mr-1"></i> List
		            			</button>
						</div>
					</div>
					
					
					<div th:if="${deleteoption=='delete'}" class="card-header d-flex justify-content-between align-items-center" style="font-family: 'Nunito', sans-serif; font-size: 1.5rem; font-weight: bold; color: black;">
        				<div STYLE="font-size: 1.3rem;">Bill Of Material-Delete<span
								th:text="${'('+bomdetails[0].bomId+')'}"></span> <input
								type="hidden" id="bomid" th:value="${bomdetails[0].bomId}" /></div>
        				<div>
		        				<button class="btn btn-light btn-sm" onclick="listpage(event);" style="color: black; font-weight: bold; border-color: black;">
		                			<i class="fas fa-list mr-1"></i> List
		            			</button>
						</div>
					</div>
					
					
					
					<br>
					<!-- Table -->
					<div class="">
						<div class="col-lg-12" style="margin-top:-15px;">
							
								<div class="table-responsive"
										style="overflow-y: auto; overflow-x: hidden; height: 85vh; border: 1px solid #dee2e6;">
							

								<div class="container-fluid">
									<div class="row">
										<div class="col-lg-12"></div>
									</div>
									<!-- Table -->

									<div class="row">
										<div class="col-lg-12">
											
												<form method="post" autocomplete="off" id="addStockHistory"
													th:fragment="finuserapply">

													<div class="card-body" style="padding: 10px;">
														<table id="dynamicFieldsTable1"
															class="table table-bordered">
															<thead>
																<tr>
																	<th>SNo.</th>
																	<th>Item Code</th>
																	<th>Item Name</th>
																	<th>HSN Code</th>
																	<th>Category Name</th>
																	<!-- <th>Expiry Date</th> -->
																	<th>Base Unit</th>
																	<th>Qty/Unit</th>


																</tr>
															</thead>
															<tbody>
																<tr th:each=" bomforview, iterStat : ${bomdetails}">
																	<td class="srl-no" th:text="${iterStat.count}" >1</td>

																	<td style="width: 110px;"><input type="text"
																		th:value="${bomforview.itemCode}" name="itemCode"
																		onchange="product_name_typeFunction1(this)" readonly
																		id="itemCode"
																		style="width: 100%; text-align: center; "
																		list="pronameList"> <datalist id="pronameList">
																			<option th:each="operator : ${rawmaterial}"
																				th:value="${operator.itemCode +'-' + operator.itemName }"
																				th:text="${operator.itemCode + '-' + operator.itemName}"></option>
																		</datalist></td>

																	<td><input type="text" name="itemname"
																		th:value="${bomforview.itemName}" id="itemname"
																		style="width: 100%; text-align: center; "
																		readonly></td>



																	<td style="width: 110px;"><input type="text"
																		name="hsncode" id="hsncode"
																		th:value="${bomforview.hsnCode}"
																		style="width: 100%; text-align: center; "
																		readonly></td>

																	<td><input type="text" name="category_name1"
																		id="category_name1"
																		th:value="${bomforview.categoryName}"
																		style="width: 100%; text-align: center;"
																		readonly></td>




																	<td><input type="text" name="baseunit"
																		th:value="${bomforview.baseUnit}" id="baseunit"
																		style="width: 100%; text-align: center; "
																		readonly></td>

																	<td><input type="text" name="Quantity"
																		th:value="${bomforview.qty}" id="Quantity"
																		style="width: 100%; text-align: center;"
																		readonly></td>

																	<!-- 
																	<td><button type="button"
																			class="btn btn-success add-btnn">Add</button></td> -->
																</tr>
															</tbody>
														</table>

														<div class="card-header"
															style="font-family: 'Nunito', sans-serif; font-size: 23px; font-weight: 600; padding: 1.7rem;">

															<div class="float-left">
																<h6 style="font-size: 1.5rem; color: black;">Other
																	Expenses</h6>
															</div>


														</div>



														<table id="dynamicFieldsTableex"
															class="table table-bordered">
															<thead>
																<tr>
																	<th>SNo.</th>
																	<th>Expenses Type</th>
																	<th>Expenses cost</th>

																</tr>
															</thead>
															<tbody>
																<tr th:each=" getvalue ,iterStat : ${getnullvalue}">
																	<td class="srl-no" th:text="${iterStat.count}">1</td>
																	<td><input type="text" name="ExpensesType[]"
																		id="ExpensesType" list="Expenseslist"
																		th:value="${ getvalue.expensesType}"
																		style="width: 100%; " readonly>
																		<datalist id="Expenseslist">
																			<option>Labour Cost</option>
																			<option>Machinary Cost</option>
																			<option>Electricity Cost</option>
																			<option>Overhead Cost</option>
																		</datalist></td>


																	<td><input type="text" name="per/Amount[]"
																		id="per/Amount" th:value="${ getvalue.expensesCost}"
																		style="width: 100%;" readonly></td>

																	<!-- 						<td><button type="button"
																			class="btn btn-success add-btnn">Add</button></td> -->
																</tr>
															</tbody>
														</table>



														<div class="form-row align-items-center">
															<div class="form-group col-md-2">
																<label for="productName">Mfg Product Name:</label>
															</div>
															<div class="form-group col-md-2">
																<input type="text" class="form-control"
																	th:value="${bomdetails[0].mfgProductName}"
																	id="makingproductName" placeholder="Enter product name"
																	style="border-color: #333333;"
																	readonly>
															</div>
															<div class="form-group col-md-2"></div>
															<div class="form-group col-md-1"></div>
														</div>


													</div>
												</form>
											</div>
										</div>
									</div>
									</div>


								</div>
								<br>

								<div class="card-footer text-center"
									style="font-family: 'Nunito', sans-serif; font-size: 23px; font-weight: 600;">

									<button class="btn btn-xs btn-dark" type="button"
										id="Dashboard" onclick="contentLoad(this)">Home</button>
									<button class="btn btn-xs btn-dark" type="button"
										th:if="${deleteoption == 'delete'}"
										th:attr="data-bom=${bomdetails[0].bomId}" id="Dashboard"
										onclick="deletebom(this)">Submit</button>


									<button class="btn btn-xs btn-dark" type="button" id="btnBack"
										onclick="back();">Back</button>

								</div>




							</div>
						</div>
						</form>
					</div>
					</div>
				



				<!-- --------modify----------- -->



				<div class="container-fluid content" th:if="${formmode}=='modify'">
				<div class="row">
						
						<form action="#" method="post" class="w-100"
							id="VendorRegistrationadd" autocomplete="off">
				<div class="card ">
					
					<div class="card-header d-flex justify-content-between align-items-center" style="font-family: 'Nunito', sans-serif; font-size: 1.5rem; font-weight: bold; color: black;">
        				<div STYLE="font-size: 1.3rem;">Bill Of Material-Modify<span
								th:text="${'('+bomdetails[0].bomId+')'}"></span> <input
								type="hidden" id="bomid" th:value="${bomdetails[0].bomId}" /></div>
        				<div>
		        				<button class="btn btn-light btn-sm" onclick="listpage(event);"style="color: black; font-weight: bold; border-color: black;">
		                			<i class="fas fa-list mr-1"></i> List
		            			</button>
						</div>
					</div>
					
					<br>
					<!-- Table -->
					<div class="card-body">

									<div class="card-body" style="padding: 1rem;">
							
								<div class="table-responsive"
										style="overflow-y: auto; overflow-x: hidden; height: 85vh; border: 1px solid #dee2e6;">
							

								<div class="container-fluid">
									<div class="row">
										<div class="col-lg-12"></div>
									</div>
									<!-- Table -->

									<div class="row">
										<div class="col-lg-12">
											
												<form method="post" autocomplete="off" id="addStockHistory"
													th:fragment="finuserapply">

													<div class="card-body" style="padding: 10px;">
														<table id="dynamicFieldsTable1"
															class="table table-bordered">
															<thead>
																<tr>
																	<th>SNo.</th>
																	<th>Item Code</th>
																	<th>Item Name</th>
																	<th>HSN Code</th>
																	<th>Category Name</th>
																	<!-- <th>Expiry Date</th> -->
																	<th>Base Unit</th>
																	<th>Qty/Unit</th>
																	<th >Action</th>

																</tr>
															</thead>
															<tbody>
																<tr th:each=" bomforview : ${bomdetails}">
																	<td class="srl-no">1</td>

																	<td style="width: 110px;"><input type="text"
																		th:value="${bomforview.itemCode}" name="itemCode"
																		onchange="product_name_typeFunction1(this)"
																		id="itemCode"
																		style="width: 100%; text-align: center;"
																		list="pronameList"> <datalist id="pronameList">
																			<option th:each="operator : ${rawmaterial}"
																				th:value="${operator.itemCode +'-' + operator.itemName }"
																				th:text="${operator.itemCode + '-' + operator.itemName}"></option>
																		</datalist></td>

																	<td><input type="text" name="itemname"
																		th:value="${bomforview.itemName}" id="itemname"
																		style="width: 100%; text-align: center;"></td>



																	<td style="width: 110px;"><input type="text"
																		name="hsncode" id="hsncode"
																		th:value="${bomforview.hsnCode}"
																		style="width: 100%; text-align: center;"
																		readonly></td>

																	<td><input type="text" name="category_name1"
																		id="category_name1"
																		th:value="${bomforview.categoryName}"
																		style="width: 100%; text-align: center;"
																		readonly></td>




																	<td><input type="text" name="baseunit"
																		th:value="${bomforview.baseUnit}" id="baseunit"
																		style="width: 100%; text-align: center;"></td>

																	<td><input type="text" name="Quantity"
																		th:value="${bomforview.qty}" id="Quantity"
																		style="width: 100%; text-align: center;">

																		<input type="hidden" id="refid" name="refid"
																		th:value="${bomforview.id}" /></td>
																		
																	
																	<td style="text-align: center;">
																	    <div style="display: flex; gap: 10px; justify-content: center; align-items: center;">
																	        <!-- Plus icon -->
																	        <span class="add-btnn" style="cursor: pointer; font-size: 20px; color: green;">
																	            <i class="fas fa-plus add-btnn"></i>
																	        </span>
																	        
																	        <!-- Trash (delete) icon -->
																	        <span class="remove-btnn" style="cursor: pointer; font-size: 20px; color: red;">
																	            <i class="fas fa-trash remove-btnn"></i>
																	        </span>
																	    </div>
																	</td>
																		




																	<!--<td><button type="button"
																			class="btn btn-success add-btnn">Add</button></td>
																			<td style="text-align: center;"><button class="btn btn-danger btn-sm remove-btnn">-</button></td>-->	
																			<!-- <td><button type="button"  class="btn btn-danger remove-btnn"  onclick="removedata();">Remove</button></td> -->


																</tr>
															</tbody>
														</table>
														<!--<button style ="width:35px; margin-top:-24px"  class="btn btn-dark add-btnn">+</button>
														<div></div>
														<br>-->

														

														<div class="card-header"
															style="font-family: 'Nunito', sans-serif; font-size: 23px; font-weight: 600; padding: 1.7rem;">

															<div class="float-left">
																<h6 style="font-size: 1.5rem; color: black;">Other
																	Expenses</h6>
															</div>


														</div>



														<table id="dynamicFieldsTableex"
															class="table table-bordered">
															<thead>
																<tr>
																	<th>SNo.</th>
																	<th>Expenses Type</th>
																	<th>Expenses Cost</th>
																	<th>Actions</th>
																</tr>
															</thead>
															<tbody>
															<tr th:if="${#lists.isEmpty(getnullvalue)}">
																<td class="srl-no">1</td>
																	<td><input type="text" name="ExpensesType[]"
																		id="ExpensesType" list="Expenseslist"
																		style="width: 100%; "> <datalist
																			id="Expenseslist">
																			<option>Labour cost</option>
																			<option>Machinary cost</option>
																			<option>Electricity cost</option>
																			<option>Overhead cost</option>
																		</datalist></td>


																	<td><input type="text" name="per/Amount[]"
																		id="per/Amount"
																		style="width: 100%;"></td>

																	<!--<td style="text-align: center; vertical-align: middle;"><button type="button" 
																			class="btn btn-success add-btnn">Add</button></td>-->
																	<!--<td style="text-align: center;"><button class="btn btn-danger btn-sm remove-btnn">-</button></td>-->
																	<td style="text-align: center;">
																	    <div style="display: flex; gap: 10px; justify-content: center; align-items: center;">
																	        <!-- Plus icon -->
																	        <span class="add-btnn" style="cursor: pointer; font-size: 20px; color: green;">
																	            <i class="fas fa-plus add-btnn"></i>
																	        </span>
																	        
																	        <!-- Trash (delete) icon -->
																	        <span class="remove-btnn" style="cursor: pointer; font-size: 20px; color: red;">
																	            <i class="fas fa-trash remove-btnn"></i>
																	        </span>
																	    </div>
																	</td>
															</tr>
																<tr th:each=" getvalue : ${getnullvalue}">
																	<td class="srl-no">1</td>
																	<td><input type="text" name="ExpensesType[]"
																		id="ExpensesType" list="Expenseslist"
																		th:value="${ getvalue.expensesType}"
																		style="width: 100%;"> <datalist
																			id="Expenseslist">
																			<option>Labour Cost</option>
																			<option>Machinary Cost</option>
																			<option>Electricity Cost</option>
																			<option>Overhead Cost</option>
																		</datalist></td>


																	<td><input type="text" name="per/Amount[]"
																		id="per/Amount" th:value="${ getvalue.expensesCost}"
																		style="width: 100%;"> <input
																		type="hidden" id="refidexpen" name="refidexpen"
																		th:value="${getvalue.id}" /></td>

																	<!--<td><button type="button"
																			class="btn btn-success add-btnn">Add</button></td>-->
																	<td style="text-align: center;">
																	    <div style="display: flex; gap: 10px; justify-content: center; align-items: center;">
																	        <!-- Plus icon -->
																	        <span class="add-btnn" style="cursor: pointer; font-size: 20px; color: green;">
																	            <i class="fas fa-plus add-btnn"></i>
																	        </span>
																	        
																	        <!-- Trash (delete) icon -->
																	        <span class="remove-btnn" style="cursor: pointer; font-size: 20px; color: red;">
																	            <i class="fas fa-trash remove-btnn"></i>
																	        </span>
																	    </div>
																	</td>			
																			
																	<!--<td style="text-align: center;"><button class="btn btn-danger btn-sm remove-btnn">-</button></td>-->		
																</tr>
															</tbody>
														</table>
														<!--<button style ="width:35px; margin-top:-24px"  class="btn btn-dark add-btnnn">+</button>
														<div></div>
														<br>-->

														



														<div class="form-row align-items-center">
															<div class="form-group col-md-2">
																<label for="productName">Mfg Product Name:</label>
															</div>
															<div class="form-group col-md-2">
																<input type="text" class="form-control"
																	th:value="${bomdetails[0].mfgProductName}"
																	id="makingproductName" placeholder="Enter product name"
																	style="border-color: #333333; border-radius: 8px;"
																	required>
															</div>
															<div class="form-group col-md-2"></div>
															<div class="form-group col-md-1"></div>
														</div>


													</div>
												</form>
											</div>
										</div>
									</div>
									</div>


								
								<br>


								<div class="card-footer text-center"
									style="font-family: 'Nunito', sans-serif; font-size: 23px; margin-top:-10px; font-weight: 600;">

									<button class="btn btn-xs btn-dark" type="button"
										id="Dashboard" onclick="contentLoad(this)">Home</button>
									<button class="btn btn-xs btn-dark" id="btnSubmit"
										onclick="addmodifyproduct(event);">Submit</button>
									<button class="btn btn-xs btn-dark" type="button" id="btnBack"
										onclick="back();">Back</button>

								</div>




							
						</div>
					</div>
				</div>











</form>
			</div>
			</div>






			<!-- Menu -->
			<div class="dash-app" th:if="${formmode}==null">
				<div class="spur-card-title"
					style="font-size: 25px; background-color: rgba(0, 0, 0, .03); color: black; padding: 1rem 1.3rem; margin-bottom: 0; border-bottom: 1px solid #17a2b852;">
					<div class="spur-card-title">
						Processing
						<div class="float-right">
							<button class="btn btn-primary"
								onclick="location.href='./process?formmode=add';">Add
								New Product</button>
						</div>
					</div>
				</div>
				<br>
				<!-- Table -->
				<div class="row">
					<div class="col-lg-12">
						<div class="card ">

							<div class="container-fluid">
								<div class="row">
									<div class="col-lg-12"></div>
								</div>
								<!-- Table -->

								<div class="row">
									<div class="col-lg-12">
										<div class="card " style="margin-top: 40px">
											<form method="post" autocomplete="off" id="addStockHistory"
												th:fragment="finuserapply">
												<div class="card-header"
													style="background-color: rgba(0, 0, 0, .03); color: black; font-size: 25px; padding: 1rem 1.3rem; margin-bottom: 0; border-bottom: 1px solid #17a2b852;">
													<div class="spur-card-title">Add Process</div>
												</div>
												<br>
												<div class="row">

													<div class="form-group col-md-2">
														<label style="margin-left: 36px; font-weight: bolder;"
															for="productName">Work order id:</label>
													</div>
													<div class="form-group col-md-2">
														<input type="text" name="woid" id="woid" list="wolist"
															onchange="readMakelistOptions()" style="width: 100%;">
														<datalist id="wolist">
															<option th:each="woList : ${woList}"
																th:value="${woList.workId}" th:text="${woList.workId}"></option>
														</datalist>
													</div>


													<div class="form-group col-md-2">
														<label style="margin-left: 36px; font-weight: bolder;"
															for="productName">Select Product:</label>
													</div>
													<div class="form-group col-md-2">
														<input type="text" name="makesname[]" id="makesname"
															list="makelist" onchange="makelist_fn()"
															style="width: 100%;" readonly>
														<datalist id="makelist">
															<option th:each="operator : ${makelist}"
																th:value="${operator}" th:text="${operator}"></option>
														</datalist>
													</div>



												</div>

												<div class="card-body" style="padding: 10px;">
													<table id="dynamicFieldsTable" class="table table-bordered">
														<thead>
															<tr>
																<th>Product Name</th>
																<th>Batch</th>
																<th>Units</th>
																<th>Category Name</th>
																<th>kgs</th>
																<th>Quantity</th>
																<th>Actions</th>
															</tr>
														</thead>
														<tbody>
															<tr>
																<td><input type="text" name="product_name[]"
																	id="product_name1" list="pronameList"
																	onchange="product_name_typeFunction1(this)"
																	style="width: 100%;" readonly> <datalist
																		id="pronameList">
																		<option th:each="operator : ${productList}"
																			th:value="${operator.PRODUCT_NAME}"
																			th:text="${operator.PRODUCT_NAME}"></option>
																	</datalist></td>
																<td style="width: 110px;"><select id="BATCH"
																	onchange="getcurrentstock(this)" name="batch[]"
																	style="width: 100%;">
																		<option>SELECT</option>
																</select></td>
																<td><input type="text" name="UNITS[]" id="UNITS"
																	style="width: 100%;" readonly></td>
																<td><input type="text" name="category_name1[]"
																	id="category_name1" style="width: 100%;"></td>
																<td><input type="text" name="PKG[]" id="PKG"
																	style="width: 100%;"></td>
																<td><input type="text" name="qty[]" id="qty"
																	style="width: 100%;"></td>
																<td><button type="button"
																		class="btn btn-success add-btn">Add</button></td>
															</tr>
														</tbody>
													</table>

													<table id="dynamicFieldsTableex"
														class="table table-bordered">
														<thead>
															<tr>
																<th>Expenses Type</th>
																<th>Expenses cost</th>
																<th>Actions</th>
															</tr>
														</thead>
														<tbody>
															<tr>
																<td><input type="text" name="ExpensesType[]"
																	id="ExpensesType" list="Expenseslist"
																	style="width: 100%;"> <datalist
																		id="Expenseslist">
																		<option>Labour cost</option>
																		<option>Machinary cost</option>
																		<option>Electricity cost</option>
																		<option>Overhead cost</option>
																	</datalist></td>


																<td><input type="text" name="per/Amount[]"
																	id="per/Amount" style="width: 100%;"></td>

																<td style="text-align: center"><button
																		type="button" class="btn btn-success add-btnn">Add</button></td>
															</tr>
														</tbody>
													</table>


													<div class="form-row align-items-center">
														<div class="form-group col-md-2">
															<label style="font-weight: bolder;" for="productName">Mfg
																Product Name:</label>
														</div>
														<div class="form-group col-md-2">
															<input type="text" class="form-control"
																id="makingproductName" placeholder="Enter product name"
																style="border-color: #333333;" required>
														</div>
														<div class="form-group col-md-1">
															<label style="font-weight: bolder;" for="productName">order
																No's:</label>
														</div>
														<div class="form-group col-md-2">
															<input type="text" class="form-control" id="kilograms"
																placeholder="Enter Qty" style="border-color: #333333;"
																required>
														</div>
														<div class="form-group col-md-1"></div>
														<div class="form-group col-md-2">
															<button class="btn btn-primary" id="btnSubmit"
																style="background-color: #007bff"
																onclick="addTaxData(event);">Add Process</button>
														</div>
													</div>

												</div>








												<!-- 	<div class="card-body" style="padding: 10px;">
													<table id="dynamicFieldsTable" class="table table-bordered">
														<thead>
															<tr>
																<th>Product Name</th>
																<th>Batch</th>
																<th>GSTIN</th>
																<th>Expiry Date</th>
																<th>MRP</th>
																<th>Units in Kgs</th>
																<th>Category Name</th>
																<th>Qty</th>
																<th>Actions</th>
															</tr>
														</thead>
														<tbody>
															<tr>
																<td><input type="text" name="product_name[]"
																	id="product_name1" list="pronameList"
																	onchange="product_name_typeFunction1(this)"
																	style="width: 100%;"> <datalist
																		id="pronameList">
																		<option th:each="operator : ${productList}"
																			th:value="${operator.PRODUCT_NAME}"
																			th:text="${operator.PRODUCT_NAME}"></option>
																	</datalist></td>
																<td style="width: 110px;"><select id="BATCH"
																	onchange="getcurrentstock(this)" name="batch[]"
																	style="width: 100%;">
																		<option>SELECT</option>
																</select></td>
																<td><input type="text" name="GSTIN[]" id="GSTIN"
																	style="width: 100%;"></td>
																<td><input type="text" name="EXPIRY_DATEs[]"
																	id="EXPIRY_DATEs" style="width: 100%;"></td>
																<td><input type="text" name="MRP[]" id="MRP"
																	style="width: 100%;"></td>
																<td><input type="text" name="UNITS[]" id="UNITS"
																	style="width: 100%;"></td>
																<td><input type="text" name="category_name1[]"
																	id="category_name1" style="width: 100%;"></td>
																<td><input type="text" name="PKG[]" id="PKG"
																	style="width: 100%;"></td>
																<td><button type="button"
																		class="btn btn-success add-btn">Add</button></td>
															</tr>
														</tbody>
													</table>
													<div class="form-row align-items-center">
														<div class="form-group col-md-2">
															<label style="font-weight: bolder;" for="productName">Mfg Product Name:</label>
														</div>
														<div class="form-group col-md-2">
															<input type="text" class="form-control"
																id="makingproductName" placeholder="Enter product name"
																style="border-color: #333333;" required>
														</div>
														<div class="form-group col-md-2"></div>
														<div class="form-group col-md-1">
															<button class="btn btn-primary" id="btnSubmit"
																style="background-color: #007bff"
																onclick="addTaxData(event);">Add</button>
														</div>
													</div>

												</div> -->
											</form>
										</div>
									</div>
								</div>


							</div>
							<br>
							<div class="col-lg-12  "
								style="font-size: 25px; background-color: rgba(0, 0, 0, .03); color: black; padding: 1rem 1.3rem; margin-bottom: 0; height: 50px; border-bottom: 1px solid #17a2b852;">
								<div>Process History List</div>
							</div>
							<div class="card-body">
								<table class="table table-striped " id="dataTables">
									<thead class="stats-secondary">
										<tr>
											<th style="text-align: center; font-size: 15px">REF.No.</th>
											<th style="text-align: center; font-size: 15px">Product
												Name</th>
											<th style="text-align: center; font-size: 15px">Batch</th>
											<th style="text-align: center; font-size: 15px">Category</th>
											<th style="text-align: center; font-size: 15px">Order
												No's</th>
											<th style="text-align: center; font-size: 15px">Make</th>
											<th style="text-align: center; font-size: 15px">Status</th>

										</tr>
									</thead>
									<tbody>
										<tr th:each="listItem : ${stockLists}" class="userlist">
											<td style="text-align: center; width: 50px"
												th:text="${listItem[10]}"></td>
											<td style="text-align: center; width: 150px"
												th:text="${listItem[1]}"></td>
											<td style="text-align: center; width: 50px"
												th:text="${listItem[2]}"></td>

											<td style="text-align: center; width: 100px"
												th:text="${listItem[7]}"></td>
											<td style="text-align: center; width: 50px"
												th:text="${listItem[12]}"></td>
											<td style="text-align: center; width: 150px"
												th:text="${listItem[11]}"></td>
											<td style="text-align: center; width: 100px"
												th:text="${listItem[9]}"></td>

										</tr>
									</tbody>
								</table>



							</div>

							<div class=" col-sm-13 text-center">
								<div
									style="background-color: rgba(0, 0, 0, .03); color: black; padding: 1rem 1.3rem; margin-bottom: 0; height: 50px; border-bottom: 1px solid #17a2b852;">
									<button
										Style="width: 100px; background: #007bff; color: white; border-radius: .25rem;"
										type="button" id="Dashboard" onclick="contentLoad(this)">Home</button>
									<button
										Style="width: 100px; border-radius: .25rem; background: #007bff; color: white;"
										type="button" id="btnBack" onclick="back();">Back</button>
								</div>
							</div>

						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	
	<div class=" modal fade" id="alert">
		<div
			class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
			<div class="modal-content">
				<div class="menu-title-header">
					<div class="modal-title" id="exampleModalLabel"
						style="text-align: center; color: rgb(0, 0, 0);">ERP</div>
				</div>
				<div class="modal-body"
					style="text-align: center; background-color: #c6ccd2">
					<p id="alertmsg"></p>
					<button type="button" class="btn btn-primary" data-dismiss="modal"
						onclick="window.location.href='./tskValidation';">Close</button>
				</div>
			</div>
		</div>
	</div>	


	<!-- Confirmation Modal -->
	<div class="modal fade" id="confirmationModal" tabindex="-1"
		role="dialog" aria-labelledby="confirmationModalLabel"
		aria-hidden="true">
		<div
			class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
			<div class="modal-content">
				<div class="menu-title-header">
					<div class="modal-title" id="confirmationModalLabel"
						style="text-align: center; color: rgb(0, 0, 0);">Confirm
						Deletion</div>
				</div>
				<div class="modal-body"
					style="text-align: center; background-color: #c6ccd2">
					<p>Are you sure you want to delete this BOM?</p>
					<button type="button" class="btn btn-primary" id="confirmDeleteBtn">Yes</button>
					<button type="button" class="btn btn-secondary"
						data-dismiss="modal">No</button>
				</div>
			</div>
		</div>
	</div>


</body>

</html>